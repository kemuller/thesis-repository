a4.1 <-polr(aphids2 ~           row + pos + date,data=ss)
a4.2 <-polr(aphids2 ~ lfClass       + pos + date,data=ss)
a4.3 <-polr(aphids2 ~ lfClass + row       + date,data=ss)
a4.4 <-polr(aphids2 ~ lfClass + row + pos       ,data=ss)
anova(a4.1,a4)
anova(a4.2,a4)
anova(a4.3,a4)
anova(a4.4,a4)
a3 <-polr(aphids2 ~ lfClass + row + date,data=ss)
a3.1 <-polr(aphids2 ~         row + date,data=ss)
a3.2 <-polr(aphids2 ~ lfClass     + date,data=ss)
a3.3 <-polr(aphids2 ~ lfClass + row     ,data=ss)
anova(a3.1,a3)
anova(a3.2,a3)
anova(a3.3,a3)
a2 <-polr(aphids2 ~ lfClass     + date,data=ss)
a2.1 <-polr(aphids2 ~  date  ,data=ss)
a2.2 <-polr(aphids2 ~ lfClass,data=ss)
anova(a2.1,a2)
anova(a2.2,a2)
a1 <-polr(aphids2 ~ lfClass,data=ss)
null <-polr(aphids2 ~ 1,data=ss)
anova(null,a1,a2,a3,a4,a5,a6)
best <- polr(aphids2 ~ lfClass + date,data=ss)
(pb <- profile(best))
plot(pb)
pchisq(deviance(best),df.residual(best))
a6 <- glm(aphidsPresent ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + row + pos + date,family=binomial,data=ss)
ss[ss$aphids2 !="0","aphidsPresent"] <- 1
a6 <- glm(aphidsPresent ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + row + pos + date,family=binomial,data=ss)
summary(a6)
ss$aphidsPresent <- 0
ss[ss$aphids2 !="0","aphidsPresent"] <- 1
a6 <- glm(aphidsPresent ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + row + pos + date,family=binomial,data=ss)
summary(a6)
a5 <- glm(aphidsPresent ~  siteOfOriginPedigree + lfClass + row + pos + date,family=binomial,data=ss)
anova(a5,a6,test="F")
anova(a5,a6,test="chi")
anova(a5,a6,test="Chi")
a5.1 <- glm(aphidsPresent ~                       + lfClass + row + pos + date,family=binomial,data=ss)
a5.2 <- glm(aphidsPresent ~  siteOfOriginPedigree           + row + pos + date,family=binomial,data=ss)
a5.3 <- glm(aphidsPresent ~  siteOfOriginPedigree + lfClass       + pos + date,family=binomial,data=ss)
a5.4 <- glm(aphidsPresent ~  siteOfOriginPedigree + lfClass + row       + date,family=binomial,data=ss)
a5.5 <- glm(aphidsPresent ~  siteOfOriginPedigree + lfClass + row + pos       ,family=binomial,data=ss)
anova(a5.1,a5,test="Chi")
anova(a5.2,a5,test="Chi")
anova(a5.3,a5,test="Chi")
anova(a5.4,a5,test="Chi")
anova(a5.5,a5,test="Chi")
anova(a5.1,a5,test="Chi")
a4 <- glm(aphidsPresent ~ lfClass + row + pos + date,family=binomial,data=ss)
a4.1 <- glm(aphidsPresent ~        + row + pos + date,family=binomial,data=ss)
a4.2 <- glm(aphidsPresent ~ lfClass      + pos + date,family=binomial,data=ss)
a4.3 <- glm(aphidsPresent ~ lfClass + row      + date,family=binomial,data=ss)
a4.4 <- glm(aphidsPresent ~ lfClass + row + pos       ,family=binomial,data=ss)
anova(a4.1,a4,test="Chi")
anova(a4.2,a4,test="Chi")
anova(a4.3,a4,test="Chi")
anova(a4.1,a4,test="Chi")
anova(a4.2,a4,test="Chi")
anova(a4.3,a4,test="Chi")
anova(a4.4,a4,test="Chi")
a3 <- glm(aphidsPresent ~ lfClass + row + pos       ,family=binomial,data=ss)
a3 <- glm(aphidsPresent ~ lfClass + row + pos       ,family=binomial,data=ss)
a3.1 <- glm(aphidsPresent ~       + row + pos       ,family=binomial,data=ss)
a3.2 <- glm(aphidsPresent ~ lfClass     + pos       ,family=binomial,data=ss)
a3.3 <- glm(aphidsPresent ~ lfClass + row           ,family=binomial,data=ss)
anova(a3.1,a3,test="Chi")
anova(a3.2,a3,test="Chi")
anova(a3.3,a3,test="Chi")
anova(a3.1,a3,test="Chi")
anova(a3.2,a3,test="Chi")
anova(a3.3,a3,test="Chi")
a2 <- glm(aphidsPresent ~ lfClass     + pos       ,family=binomial,data=ss)
a2.1 <- glm(aphidsPresent ~             pos       ,family=binomial,data=ss)
a2.2 <- glm(aphidsPresent ~ lfClass               ,family=binomial,data=ss)
anova(a2.1,a2,test="Chi")
anova(a2.2,a2,test="Chi")
a2 <- glm(aphidsPresent ~ lfClass     + pos       ,family=binomial,data=ss)
a2.1 <- glm(aphidsPresent ~             pos       ,family=binomial,data=ss)
a2.2 <- glm(aphidsPresent ~ lfClass               ,family=binomial,data=ss)
anova(a2.1,a2,test="Chi")
anova(a2.2,a2,test="Chi")
a1 <-  glm(aphidsPresent ~  lfClass      ,family=binomial,data=ss)
null <- glm(aphidsPresent ~ 1, family=binomial, data=ss)
anova(null,a1,a2,a3,a4,a5,a6,test="Chi")
ss[ss$aphids2 %in% c("0","1-10"),"aphidLH"] <- "0-10"
ss[ss$aphids2 %in% c("11-80",">80"),"aphidLH"] <- ">10"
ss[ss$aphids2 %in% c("0","1-10"),"aphidLH"] <- 0
ss[ss$aphids2 %in% c("11-80",">80"),"aphidLH"] <- 1
best <- glm(aphidsPresent ~ lfClass,family=binomial,data=ss)
best <- glm(aphidsPresent ~ lfClass,family=binomial,data=ss)
summary(best)
par(mfcol=c(2,2))
plot(best)
par(mfcol=c(1,1))
best <- glm(aphidsPresent ~ lfClass,family=quasibinomial,data=ss)
summary(best)
par(mfcol=c(2,2))
plot(best)
par(mfcol=c(1,1))
ss[ss$aphids2 %in% c("0","1-10"),"aphidLH"] <- 0
ss[ss$aphids2 %in% c("11-80",">80"),"aphidLH"] <- 1
a6 <- glm(aphidLH ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + row + pos + date,family=binomial,data=ss)
ss$aphidLH
ss$aphidLH <- 0
ss[ss$aphids2 %in% c("0","1-10"),"aphidLH"] <- 0
ss[ss$aphids2 %in% c("11-80",">80"),"aphidLH"] <- 1
ss$aphidLH
a6 <- glm(aphidLH ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + row + pos + date,family=binomial,data=ss)
summary(a6)
a6 <- glm(aphidLH ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + row + pos + date,family=quasibinomial,data=ss)
summary(a6)
a5 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row + pos + date,family=binomial,data=ss)
anova(a5,a6,test="Chi")
a5.1 <- glm(aphidLH ~                       + lfClass + row + pos + date,family=binomial,data=ss)
a5.2 <- glm(aphidLH ~  siteOfOriginPedigree           + row + pos + date,family=binomial,data=ss)
a5.3 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass       + pos + date,family=binomial,data=ss)
a5.4 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row       + date,family=binomial,data=ss)
a5.5 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row + pos       ,family=binomial,data=ss)
anova(a5.1,a5,test="Chi")
a6 <- glm(aphidLH ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + row + pos + date,family=quasibinomial,data=ss)
summary(a6)
a5 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row + pos + date,family=binomial,data=ss)
anova(a5,a6,test="F")
a5.1 <- glm(aphidLH ~                       + lfClass + row + pos + date,family=quasibinomial,data=ss)
a5.2 <- glm(aphidLH ~  siteOfOriginPedigree           + row + pos + date,family=quasibinomial,data=ss)
a5.3 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass       + pos + date,family=quasibinomial,data=ss)
a5.4 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row       + date,family=quasibinomial,data=ss)
a5.5 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row + pos       ,family=quasibinomial,data=ss)
anova(a5.1,a5,test="F")
a5 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row + pos + date,family=quasibinomial,data=ss)
anova(a5,a6,test="F")
a5.1 <- glm(aphidLH ~                       + lfClass + row + pos + date,family=quasibinomial,data=ss)
a5.2 <- glm(aphidLH ~  siteOfOriginPedigree           + row + pos + date,family=quasibinomial,data=ss)
a5.3 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass       + pos + date,family=quasibinomial,data=ss)
a5.4 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row       + date,family=quasibinomial,data=ss)
a5.5 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row + pos       ,family=quasibinomial,data=ss)
anova(a5.1,a5,test="F")
anova(a5.2,a5,test="F")
anova(a5.3,a5,test="F")
anova(a5.4,a5,test="F")
anova(a5.5,a5,test="F")
anova(a5.1,a5,test="F")
anova(a5.4,a5,test="F")
anova(a5.4,a5,test="F")
a4 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row       + date,family=quasibinomial,data=ss)
a4 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row       + date,family=quasibinomial,data=ss)
a4.1 <- glm(aphidLH ~                       lfClass + row       + date,family=quasibinomial,data=ss)
a4.2 <- glm(aphidLH ~  siteOfOriginPedigree         + row       + date,family=quasibinomial,data=ss)
a4.3 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass           + date,family=quasibinomial,data=ss)
a4.4 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row            ,family=quasibinomial,data=ss)
anova(a4.1,a4,test="F")
anova(a4.2,a4,test="F")
anova(a4.3,a4,test="F")
anova(a4.4,a4,test="F")
anova(a4.1,a4,test="F")
a3 <- glm(aphidLH ~ lfClass + row +        +date,family=quasibinomial,data=ss)
a3.1 <- glm(aphidLH ~           row +        +date,family=quasibinomial,data=ss)
a3.2 <- glm(aphidLH ~ lfClass +              +date,family=quasibinomial,data=ss)
a3.3 <- glm(aphidLH ~ lfClass + row +             ,family=quasibinomial,data=ss)
a3.3 <- glm(aphidLH ~ lfClass + row               ,family=quasibinomial,data=ss)
anova(a3.1,a3,test="F")
anova(a3.2,a3,test="F")
anova(a3.3,a3,test="F")
anova(a3.1,a3,test="F")
anova(a3.2,a3,test="F")
anova(a3.3,a3,test="F")
a2 <- glm(aphidLH ~ lfClass     + date       ,family=quasibinomial,data=ss)
a2.1 <- glm(aphidLH ~             pos       ,family=quasibinomial,data=ss)
a2.2 <- glm(aphidLH ~ lfClass               ,family=quasibinomial,data=ss)
anova(a2.1,a2,test="F")
anova(a2.2,a2,test="F")
a1 <-  glm(aphidLH ~  lfClass      ,family=quasibinomial,data=ss)
null <- glm(aphidLH ~ 1, family=quasibinomial, data=ss)
anova(null,a1,a2,a3,a4,a5,a6,test="F")
best <- glm(aphidLH ~ lfClass,family=quasibinomial,data=ss)
summary(best)
par(mfcol=c(2,2))
plot(best)
par(mfcol=c(1,1))
ss <- pp97[pp97$measureYr==2004,]
str(ss)
table(ss$measureDt2)
ss$date <- factor(ss$measureDt2)
zz <- tapply(ss$aphids2,list(ss$aphids2,ss$date),length)
zz[is.na(zz)] <- 0
barplot(zz)
#no obvious difference
table(ss[ss$Status=="basal","basalLfCt"])
sum(ss[ss$Status=="basal","basalLfCt"]<=3)
sum(ss[ss$Status=="basal","basalLfCt"]>=4)
ss$lfClass <- ""
ss[ss$basalLfCt >=4,"lfClass"] <- ">3"
ss[ss$basalLfCt <=3,"lfClass"] <- "1-3"
ss[ss$Status=="flowering","lfClass"] <- "flowering"
ss$lfClass <- factor(ss$lfClass, levels=c("1-3",">3","flowering"))
uu <- table(ss$lfClass,ss$siteOfOriginPedigree)#look at distribution of plant sizes/status among pops
apply(uu,2,sum) #exclude sites with <10 plants
#exclude tower (only 1 plant)
ss <- ss[!ss$siteOfOriginPedigree %in% c("BTG","TH"),]
ss$siteOfOriginPedigree <- factor(ss$siteOfOriginPedigree,levels=unique(ss$siteOfOriginPedigree))
table(ss$siteOfOriginPedigree)
ss$aphids2 <- ordered(ss$aphids2,levels=c("0","1-10","11-80",">80"))
table(ss$lfClass,ss$siteOfOriginPedigree)
table(ss$aphids2,ss$siteOfOriginPedigree)
library(MASS)
a6 <-polr(aphids2 ~ lfClass:siteOfOriginPedigree + lfClass + siteOfOriginPedigree + row + pos + date,data=ss)
a5 <-polr(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos + date,data=ss)
anova(a5,a6)
a5.1 <-polr(aphids2 ~           siteOfOriginPedigree + row + pos + date,data=ss)
a5.2 <-polr(aphids2 ~ lfClass                        + row + pos + date,data=ss)
a5.3 <-polr(aphids2 ~ lfClass + siteOfOriginPedigree       + pos + date,data=ss)
a5.4 <-polr(aphids2 ~ lfClass + siteOfOriginPedigree + row       + date,data=ss)
a5.5 <-polr(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos        ,data=ss)
anova(a5.1,a5)
anova(a5.2,a5)
anova(a5.3,a5)
anova(a5.4,a5)
anova(a5.5,a5)
a4 <-polr(aphids2 ~   lfClass + row + pos + date,data=ss)
a4.1 <-polr(aphids2 ~           row + pos + date,data=ss)
a4.2 <-polr(aphids2 ~ lfClass       + pos + date,data=ss)
a4.3 <-polr(aphids2 ~ lfClass + row       + date,data=ss)
a4.4 <-polr(aphids2 ~ lfClass + row + pos       ,data=ss)
anova(a4.1,a4)
anova(a4.2,a4)
anova(a4.3,a4)
anova(a4.4,a4)
a3 <-polr(aphids2 ~ lfClass + pos + date,data=ss)
a3.1 <-polr(aphids2 ~         pos + date,data=ss)
a3.2 <-polr(aphids2 ~ lfClass     + date,data=ss)
a3.3 <-polr(aphids2 ~ lfClass + pos     ,data=ss)
anova(a3.1,a3)
anova(a3.2,a3)
anova(a3.3,a3)
a2 <-polr(aphids2 ~ lfClass + date,data=ss)
a2.1 <-polr(aphids2 ~  date        ,data=ss)
a2.2 <-polr(aphids2 ~ lfClass      ,data=ss)
anova(a2.1,a2)
anova(a2.2,a2)
a1 <-polr(aphids2 ~ lfClass,data=ss)
null <-polr(aphids2 ~ 1,data=ss)
anova(null,a1,a2,a3,a4,a5,a6)
best <- polr(aphids2 ~ lfClass + row + pos + date, data=ss)
best <- polr(aphids2 ~ lfClass + row + pos + date, data=ss)
(pb <- profile(best))
plot(pb)
pairs(pb)
pchisq(deviance(best),df.residual(best))
levels(ss$lfClass)
table(ss$date)
newd <- data.frame(lfClass=levels(ss$lfClass),date="2004-08-08")
pred <- predict(best,type="prob",newdata=newd)
median(ss$pos)
newd <- data.frame(lfClass=levels(ss$lfClass),date="2004-08-08",pos=median(ss$pos),row=median(ss$row))
newd
pred <- predict(best,type="prob",newdata=newd)
obs <- tapply(ss$lfClass,list(ss$lfClass,ss$aphids2),length)
(obs <- obs/apply(obs,1,sum))
par(mfcol=c(1,2))
barplot(pred,beside=T)
legend("topleft",legend="pred.")
barplot(obs,beside=T)
legend("topleft",legend="obs")
par(mfcol=c(1,1))
par(mfcol=c(1,2))
barplot(pred,beside=T)
legend("topleft",legend="pred.",bty="n")
barplot(obs,beside=T)
legend("topleft",legend="obs",bty="n")
par(mfcol=c(1,1))
barplot(pred,beside=T,legend.text=T)
legend("topright",legend=levels(ss$lfClass))
legend("topright",legend=levels(ss$lfClass),fill=T)
par(mfcol=c(1,2))
barplot(pred,beside=T)
legend("topleft",legend="pred.",bty="n")
barplot(obs,beside=T)
legend("topleft",legend="obs",bty="n")
par(mfcol=c(1,1))
par(mfcol=c(1,2))
barplot(pred,beside=T,ylim=c(0,1))
legend("topleft",legend="pred.",bty="n")
barplot(obs,beside=T,ylim=c(0,1))
legend("topleft",legend="obs",bty="n")
par(mfcol=c(1,1))
ss$aphidLH <- 0
ss[ss$aphids2 %in% c("0","1-10"),"aphidLH"] <- 0
ss[ss$aphids2 %in% c("11-80",">80"),"aphidLH"] <- 1
a6 <- glm(aphidLH ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + row + pos + date,family=quasibinomial,data=ss)
summary(a6)
a5 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row + pos + date,family=quasibinomial,data=ss)
anova(a5,a6,test="F")
a5.1 <- glm(aphidLH ~                       + lfClass + row + pos + date,family=quasibinomial,data=ss)
a5.2 <- glm(aphidLH ~  siteOfOriginPedigree           + row + pos + date,family=quasibinomial,data=ss)
a5.3 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass       + pos + date,family=quasibinomial,data=ss)
a5.4 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row       + date,family=quasibinomial,data=ss)
a5.5 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row + pos       ,family=quasibinomial,data=ss)
anova(a5.1,a5,test="F")
anova(a5.2,a5,test="F")
a5 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row + pos + date,family=quasibinomial,data=ss)
a5.1 <- glm(aphidLH ~                         lfClass + row + pos + date,family=quasibinomial,data=ss)
a5.2 <- glm(aphidLH ~  siteOfOriginPedigree           + row + pos + date,family=quasibinomial,data=ss)
a5.3 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass       + pos + date,family=quasibinomial,data=ss)
a5.4 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row       + date,family=quasibinomial,data=ss)
a5.5 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + row + pos       ,family=quasibinomial,data=ss)
anova(a5.1,a5,test="F")
anova(a5.2,a5,test="F")
anova(a5.3,a5,test="F")
anova(a5.4,a5,test="F")
anova(a5.5,a5,test="F")
anova(a5.1,a5,test="F")
anova(a5.2,a5,test="F")
anova(a5.3,a5,test="F")
anova(a5.3,a5,test="F")
anova(a5.2,a5,test="F")
anova(a5.3,a5,test="F")
anova(a5.4,a5,test="F")
anova(a5.5,a5,test="F")
anova(a5.3,a5,test="F")
a4 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + pos       + date,family=quasibinomial,data=ss)
a4.1 <- glm(aphidLH ~                       lfClass + pos       + date,family=quasibinomial,data=ss)
a4.2 <- glm(aphidLH ~  siteOfOriginPedigree         + pos       + date,family=quasibinomial,data=ss)
a4.3 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass           + date,family=quasibinomial,data=ss)
a4.4 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass + pos            ,family=quasibinomial,data=ss)
anova(a4.1,a4,test="F")
anova(a4.2,a4,test="F")
anova(a4.3,a4,test="F")
anova(a4.4,a4,test="F")
anova(a4.3,a4,test="F")
a3 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass           + date,family=quasibinomial,data=ss)
a3.1 <- glm(aphidLH ~                         lfClass           + date,family=quasibinomial,data=ss)
a3.2 <- glm(aphidLH ~  siteOfOriginPedigree                     + date,family=quasibinomial,data=ss)
a3.3 <- glm(aphidLH ~  siteOfOriginPedigree + lfClass                  ,family=quasibinomial,data=ss)
anova(a3.1,a3,test="F")
anova(a3.2,a3,test="F")
anova(a3.3,a3,test="F")
a2 <- glm(aphidLH ~ lfClass     + date       ,family=quasibinomial,data=ss)
a2 <- glm(aphidLH ~ lfClass     + date       ,family=quasibinomial,data=ss)
a2.1 <- glm(aphidLH ~             date       ,family=quasibinomial,data=ss)
a2.2 <- glm(aphidLH ~ lfClass               ,family=quasibinomial,data=ss)
anova(a2.1,a2,test="F")
anova(a2.2,a2,test="F")
a1 <-  glm(aphidLH ~  lfClass      ,family=quasibinomial,data=ss)
null <- glm(aphidLH ~ 1, family=quasibinomial, data=ss)
anova(null,a1,a2,a3,a4,a5,a6,test="F")
best <- glm(aphidLH ~ siteOfOriginPedigree*lfClass + date,family=quasibinomial,data=ss)
best <- glm(aphidLH ~ siteOfOriginPedigree*lfClass + date,family=quasibinomial,data=ss)
summary(best)
par(mfcol=c(2,2))
plot(best)
par(mfcol=c(1,1))
sort(dimnames(table(ss$siteOfOriginPedigree))[[1]])
table(ss$siteOfOriginPedigree)
newd <- data.frame(siteOfOriginPedigree=dimnames(sort(table(ss$siteOfOriginPedigree)))[[1]])
newd
table(ss$lfClass)
table(ss$date)
newd <- data.frame(siteOfOriginPedigree=dimnames(sort(table(ss$siteOfOriginPedigree)))[[1]],lfClass="<3",date="2004-08-08")
pred <- predict(best,type="response",newdata=newd)
newd <- data.frame(siteOfOriginPedigree=dimnames(sort(table(ss$siteOfOriginPedigree)))[[1]],lfClass=">3",date="2004-08-08")
pred <- predict(best,type="response",newdata=newd)
newd$fit <- pred$fit
pred <- predict(best,type="response",newdata=newd)
pred
pred <- predict(best,type="response",newdata=newd,se.fit=T)
newd$fit <- pred$fit
newd$se <- pred$se.fit
barplot(newd$fit)
bp <- barplot(newd$fit)
segments(bp,newd$fit + newd$se,bp,newd$fit-newd$se)
sites <- dimnames(sort(table(ss$siteOfOriginPedigree)))[[1]]
newd <- data.frame(siteOfOriginPedigree=sites,lfClass=">3",date="2004-08-08")
pred <- predict(best,type="response",newdata=newd,se.fit=T)
newd$fit <- pred$fit
newd$se <- pred$se.fit
text(bp,0.03,labels=sites)
tapply(ss$aphidLH,ss$siteOfOriginPedigree)
tapply(ss$aphidLH,ss$siteOfOriginPedigree,mean)
ss$siteOfOriginPedigree <- factor(ss$siteOfOriginPedigree,levels=sites)
tapply(ss$aphidLH,ss$siteOfOriginPedigree,mean)
obs <- tapply(ss$aphidLH,ss$siteOfOriginPedigree,mean)
par(mfcol=c(1,2))
bp <- barplot(newd$fit,ylim=c(0,1))
segments(bp,newd$fit + newd$se,bp,newd$fit-newd$se)
text(bp,0.03,labels=sites)
bp <- barplot(obs,ylim=c(0,1))
text(bp,0.03,labels=sites)
par(mfcol=c(1,1))
ss$aphidsPresent <- 0
ss[ss$aphids2 !="0","aphidsPresent"] <- 1
a6 <- glm(aphidsPresent ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + row + pos + date,family=binomial,data=ss)
ss$aphidsPresent <- 0
ss[ss$aphids2 !="0","aphidsPresent"] <- 1
a6 <- glm(aphidsPresent ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + row + pos + date,family=binomial,data=ss)
summary(a6)
a6 <- glm(aphidsPresent ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + row + pos + date,family=quasibinomial,data=ss)
summary(a6)
a5 <- glm(aphidsPresent ~  siteOfOriginPedigree + lfClass + row + pos + date,family=quasibinomial,data=ss)
anova(a5,a6,test="F")
a5.1 <- glm(aphidsPresent ~                       + lfClass + row + pos + date,family=quasibinomial,data=ss)
a5.2 <- glm(aphidsPresent ~  siteOfOriginPedigree           + row + pos + date,family=quasibinomial,data=ss)
a5.3 <- glm(aphidsPresent ~  siteOfOriginPedigree + lfClass       + pos + date,family=quasibinomial,data=ss)
a5.4 <- glm(aphidsPresent ~  siteOfOriginPedigree + lfClass + row       + date,family=quasibinomial,data=ss)
a5.5 <- glm(aphidsPresent ~  siteOfOriginPedigree + lfClass + row + pos       ,family=quasibinomial,data=ss)
anova(a5.1,a5,test="F")
anova(a5.2,a5,test="F")
anova(a5.3,a5,test="F")
anova(a5.4,a5,test="F")
anova(a5.5,a5,test="F")
anova(a5.1,a5,test="F")
head(ss)
anova(a5.1,a5,test="F")
anova(a5.2,a5,test="F")
anova(a5.3,a5,test="F")
anova(a5.4,a5,test="F")
anova(a5.5,a5,test="F")
a4 <- glm(aphidsPresent ~ lfClass + row + pos + date,family=quasibinomial,data=ss)
a4.1 <- glm(aphidsPresent ~        + row + pos + date,family=quasibinomial,data=ss)
a4.2 <- glm(aphidsPresent ~ lfClass      + pos + date,family=quasibinomial,data=ss)
a4.3 <- glm(aphidsPresent ~ lfClass + row      + date,family=quasibinomial,data=ss)
a4.4 <- glm(aphidsPresent ~ lfClass + row + pos       ,family=quasibinomial,data=ss)
anova(a4.1,a4,test="F")
anova(a4.2,a4,test="F")
anova(a4.3,a4,test="F")
anova(a4.4,a4,test="F")
anova(a4.1,a4,test="F")
anova(a4.2,a4,test="F")
anova(a4.1,a4,test="F")
anova(a4.2,a4,test="F")
anova(a4.3,a4,test="F")
anova(a4.4,a4,test="F")
anova(a4.1,a4,test="F")
a4 <- glm(aphidsPresent ~ lfClass + row + pos + date,family=quasibinomial,data=ss)
a4.1 <- glm(aphidsPresent ~         row + pos + date,family=quasibinomial,data=ss)
a4.2 <- glm(aphidsPresent ~ lfClass      + pos + date,family=quasibinomial,data=ss)
a4.3 <- glm(aphidsPresent ~ lfClass + row      + date,family=quasibinomial,data=ss)
a4.4 <- glm(aphidsPresent ~ lfClass + row + pos       ,family=quasibinomial,data=ss)
anova(a4.1,a4,test="F")
anova(a4.2,a4,test="F")
anova(a4.3,a4,test="F")
anova(a4.1,a4,test="F")
anova(a4.2,a4,test="F")
anova(a4.3,a4,test="F")
anova(a4.4,a4,test="F")
a3 <- glm(aphidsPresent ~ lfClass + row      + date,family=quasibinomial,data=ss)
a3.1 <- glm(aphidsPresent ~           row      + date,family=quasibinomial,data=ss)
a3.2 <- glm(aphidsPresent ~ lfClass            + date,family=quasibinomial,data=ss)
a3.3 <- glm(aphidsPresent ~ lfClass + row            ,family=quasibinomial,data=ss)
anova(a3.1,a3,test="F")
anova(a3.2,a3,test="F")
anova(a3.3,a3,test="F")
anova(a3.2,a3,test="F")
anova(a3.2,a3,test="F")
anova(a3.1,a3,test="F")
anova(a3.2,a3,test="F")
anova(a3.3,a3,test="F")
a2 <- glm(aphidsPresent ~ lfClass     + date       ,family=quasibinomial,data=ss)
a2.1 <- glm(aphidsPresent ~             date       ,family=quasibinomial,data=ss)
a2.2 <- glm(aphidsPresent ~ lfClass               ,family=quasibinomial,data=ss)
anova(a2.1,a2,test="F")
anova(a2.2,a2,test="F")
a1 <-  glm(aphidsPresent ~  lfClass      ,family=quasibinomial,data=ss)
null <- glm(aphidsPresent ~ 1, family=quasibinomial, data=ss)
anova(null,a1,a2,a3,a4,a5,a6,test="F")
best <- glm(aphidsPresent ~ lfClass*siteOfOriginPedigree + date + row + pos,family=quasibinomial,data=ss)
summary(best)
par(mfcol=c(2,2))
plot(best)
par(mfcol=c(1,1))
a6 <-polr(aphids2 ~ lfClass:siteOfOriginPedigree + lfClass + siteOfOriginPedigree + row + pos + date,data=ss)
a5 <-polr(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos + date,data=ss)
anova(a5,a6)
##The error message probably means I shouldn't use the interaction between lfClass and siteOfOriginPedigree
a5.1 <-polr(aphids2 ~           siteOfOriginPedigree + row + pos + date,data=ss)
a5.2 <-polr(aphids2 ~ lfClass                        + row + pos + date,data=ss)
a5.3 <-polr(aphids2 ~ lfClass + siteOfOriginPedigree       + pos + date,data=ss)
a5.4 <-polr(aphids2 ~ lfClass + siteOfOriginPedigree + row       + date,data=ss)
a5.5 <-polr(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos        ,data=ss)
anova(a5.1,a5)
anova(a5.2,a5)
anova(a5.3,a5)
anova(a5.4,a5)
anova(a5.5,a5)
a4 <-polr(aphids2 ~   lfClass + row + pos + date,data=ss)
a4.1 <-polr(aphids2 ~           row + pos + date,data=ss)
a4.2 <-polr(aphids2 ~ lfClass       + pos + date,data=ss)
a4.3 <-polr(aphids2 ~ lfClass + row       + date,data=ss)
a4.4 <-polr(aphids2 ~ lfClass + row + pos       ,data=ss)
anova(a4.1,a4)
anova(a4.2,a4)
anova(a4.3,a4)
anova(a4.4,a4)
a3 <-polr(aphids2 ~ lfClass + pos + date,data=ss)
a3.1 <-polr(aphids2 ~         pos + date,data=ss)
a3.2 <-polr(aphids2 ~ lfClass     + date,data=ss)
a3.3 <-polr(aphids2 ~ lfClass + pos     ,data=ss)
anova(a3.1,a3)
anova(a3.2,a3)
anova(a3.3,a3)
a2 <-polr(aphids2 ~ lfClass + date,data=ss)
a2.1 <-polr(aphids2 ~  date        ,data=ss)
a2.2 <-polr(aphids2 ~ lfClass      ,data=ss)
anova(a2.1,a2)
anova(a2.2,a2)
a1 <-polr(aphids2 ~ lfClass,data=ss)
null <-polr(aphids2 ~ 1,data=ss)
anova(null,a1,a2,a3,a4,a5,a6)
best <- polr(aphids2 ~ lfClass*siteOfOriginPedigree + row + pos + date, data=ss)
(pb <- profile(best))
plot(pb)
