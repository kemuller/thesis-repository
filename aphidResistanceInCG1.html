<html>

<head>
<style type="text/css">.knitr.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}, 
.warning {
	font-weight: bold;
} 
.message {
	font-style: italic;
} 
.source, .output, .warning, .error, .message {
	padding: 0em 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f7f7f7;
}
.rimage.left {
  text-align: left;
}
.rimage.right {
  text-align: right;
}
.rimage.center {
  text-align: center;
}

.source {
  color: #333333;
}
.background {
  color: #F7F7F7;
}

.number {
  color: #000000;
}

.functioncall {
  color: #800054;
  font-weight: bolder;
}

.string {
  color: #9999FF;
}

.keyword {
  font-weight: bolder;
  color: black;
}

.argument {
  color: #B04005;
}

.comment {
  color: #2E9957;
}

.roxygencomment {
  color: #707AB3;
}

.formalargs {
  color: #B04005;
}

.eqformalargs {
  color: #B04005;
}

.assignement {
  font-weight: bolder;
  color: #000000;
}

.package {
  color: #96B525;
}

.slot {
  font-style: italic;
}

.symbol {
  color: #000000;
}

.prompt {
  color: #333333;
}
</style>
<title>Range of data collection dates, 2004-2012</title>
</head>

<body>
 
<p><b>Table of Contents</b></p>
<p>Click these links to see summaries of model selection for each cohort and year</p>
<p><a href="#9604sum">1996 garden, 2004 </a></p>
<p><a href="#9704sum">1997 garden, 2004 </a></p>
<p><a href="#9705sum">1997 garden, 2005 </a></p>
<p><a href="#9706sum">1997 garden, 2006 </a></p>
<p><a href="#9707sum">1997 garden, 2007 </a></p>

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment">#</span>
# <span class="functioncall">load</span>(<span class="string">'C:\\Users\\Katherine\\Dropbox\\KMullerdatasets\\cg12004-2012.RData'</span>)
<span class="comment"># #<span class="keyword">for</span> use on my computer, when I'm disconnected from the internet</span>
<span class="functioncall">load</span>(<span class="functioncall">url</span>(<span class="string">"http://dl.dropbox.com/s/e8xg6k2cqvalnhj/cg12004-2012.RData"</span>))
</pre></div><div class="warning"><pre class="knitr r">## Warning: unable to resolve 'dl.dropbox.com'
</pre></div><div class="error"><pre class="knitr r">## Error: cannot open the connection
</pre></div><div class="source"><pre class="knitr r">
lookAtYear &lt;- <span class="functioncall"><span class="keyword">function</span></span>(x) {
    <span class="functioncall">tapply</span>(pp[pp$measureYr == x, <span class="string">"measureDt2"</span>], <span class="functioncall">list</span>(pp[pp$measureYr == x, <span class="string">"measureDt2"</span>], 
        pp[pp$measureYr == x, <span class="string">"expNm"</span>]), length)
}

yrs &lt;- <span class="functioncall">c</span>(2004:2012)
<span class="functioncall">tapply</span>(yrs, yrs, lookAtYear)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div></div></div>


<p>There is a possibility that the measure dates reflect can't finds that were added later.</p>

<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r">lookAtYear &lt;- <span class="functioncall"><span class="keyword">function</span></span>(x, y) {
    <span class="functioncall">tapply</span>(pp[pp$measureYr == x &amp; pp$expNm == y, <span class="string">"measureDt2"</span>], <span class="functioncall">list</span>(pp[pp$measureYr == 
        x &amp; pp$expNm == y, <span class="string">"measureDt2"</span>], pp[pp$measureYr == x &amp; pp$expNm == 
        y, <span class="string">"Status"</span>]), length)
}

<span class="functioncall">lookAtYear</span>(2004, 1996)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2005, 1996)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2006, 1996)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2007, 1996)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2008, 1996)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2009, 1996)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2010, 1996)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2011, 1996)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2012, 1996)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r">

<span class="functioncall">lookAtYear</span>(2004, 1997)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2005, 1997)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2006, 1997)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2007, 1997)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2008, 1997)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2009, 1997)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2010, 1997)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2011, 1997)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2012, 1997)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r">

<span class="functioncall">lookAtYear</span>(2004, 1998)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2005, 1998)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2006, 1998)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2007, 1998)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2008, 1998)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2009, 1998)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2010, 1998)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2011, 1998)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2012, 1998)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r">

<span class="functioncall">lookAtYear</span>(2004, 1999)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2005, 1999)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2006, 1999)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2007, 1999)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2008, 1999)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2009, 1999)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2010, 1999)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2011, 1999)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtYear</span>(2012, 1999)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div></div></div>

It doesn't look like that's an issue.
<p></p>
<p>Visualize aphid abundance by site and year</p>

<div class="chunk" id="unnamed-chunk-3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment"># switch factor levels of aphid abundance <span class="keyword">for</span> visualizing</span>
pp$aphids2 &lt;- <span class="functioncall">factor</span>(pp$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"&gt;80"</span>, <span class="string">"11-80"</span>, <span class="string">"1-10"</span>, <span class="string">"0"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r">pp &lt;- pp[pp$Status != <span class="string">"can'tFind"</span>, ]  #only look at plants
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r">pp96 &lt;- pp[pp$expNm == 1996 &amp; pp$siteOfOriginPedigree != <span class="string">"unknown"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r">pp97 &lt;- pp[pp$expNm == 1997 &amp; pp$siteOfOriginPedigree != <span class="string">"unknown"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r">pp98 &lt;- pp[pp$expNm == 1998 &amp; pp$siteOfOriginPedigree != <span class="string">"unknown"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r">pp99 &lt;- pp[pp$expNm == 1999 &amp; pp$siteOfOriginPedigree != <span class="string">"unknown"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># fix site levels and order by size</span>
pp96$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(pp96$siteOfOriginPedigree, levels = <span class="functioncall">unique</span>(pp96$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp96' not found
</pre></div><div class="source"><pre class="knitr r">pp96$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(pp96$siteOfOriginPedigree, levels = <span class="functioncall">dimnames</span>(<span class="functioncall">sort</span>(<span class="functioncall">table</span>(pp96$siteOfOriginPedigree)))[[1]])
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp96' not found
</pre></div><div class="source"><pre class="knitr r">pp97$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(pp97$siteOfOriginPedigree, levels = <span class="functioncall">unique</span>(pp97$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r">pp97$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(pp97$siteOfOriginPedigree, levels = <span class="functioncall">dimnames</span>(<span class="functioncall">sort</span>(<span class="functioncall">table</span>(pp97$siteOfOriginPedigree)))[[1]])
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r">pp99$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(pp99$siteOfOriginPedigree, levels = <span class="functioncall">unique</span>(pp99$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp99' not found
</pre></div><div class="source"><pre class="knitr r">pp99$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(pp99$siteOfOriginPedigree, levels = <span class="functioncall">dimnames</span>(<span class="functioncall">sort</span>(<span class="functioncall">table</span>(pp99$siteOfOriginPedigree)))[[1]])
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp99' not found
</pre></div><div class="source"><pre class="knitr r">
lookAtAphids &lt;- <span class="functioncall"><span class="keyword">function</span></span>(x, y) {
    zz &lt;- <span class="functioncall">tapply</span>(x[x$measureYr == y, <span class="string">"aphids2"</span>], <span class="functioncall">list</span>(x[x$measureYr == y, <span class="string">"aphids2"</span>], 
        x[x$measureYr == y, <span class="string">"siteOfOriginPedigree"</span>]), length)
    zz[<span class="functioncall">is.na</span>(zz)] &lt;- 0
    zzt &lt;- zz
    <span class="functioncall"><span class="keyword">for</span></span> (i <span class="keyword">in</span> 1:<span class="functioncall">dim</span>(zz)[1]) {
        zzt[i, ] &lt;- zz[i, ]/<span class="functioncall">apply</span>(zz, 2, sum)
    }
    # <span class="functioncall">par</span>(xpd=T, mar=<span class="functioncall">par</span>()$mar+<span class="functioncall">c</span>(1,0,0,6)))
    cols &lt;- <span class="functioncall">gray</span>(<span class="functioncall">c</span>(<span class="functioncall">seq</span>(0, 1, by = 1/3)))
    bp &lt;- <span class="functioncall">barplot</span>(zzt, ylim = <span class="functioncall">c</span>(0, 1), col = cols)
    <span class="functioncall">text</span>(bp, 0.05, <span class="functioncall">table</span>(x[x$measureYr == y, <span class="string">"siteOfOriginPedigree"</span>]), col = <span class="string">"red"</span>)
    <span class="functioncall">legend</span>(<span class="string">"topright"</span>, legend = <span class="functioncall">levels</span>(x$aphids2), fill = cols, bty = <span class="string">"n"</span>)
    <span class="functioncall">legend</span>(<span class="string">"topleft"</span>, legend = <span class="functioncall">c</span>(<span class="functioncall">paste</span>(<span class="functioncall">unique</span>(x$expNm), <span class="string">"exp"</span>, sep = <span class="string">""</span>), y), 
        bty = <span class="string">"n"</span>)
    # <span class="functioncall">par</span>(mar=<span class="functioncall">c</span>(5,4,4,2) + 0.1)
}
</pre></div></div></div>


<b>1996 Garden, 2004-2012:</b>
<div class="chunk" id="unnamed-chunk-4"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp96, 2004)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp96' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp96, 2005)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp96' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp96, 2006)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp96' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp96, 2007)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp96' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp96, 2008)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp96' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp96, 2009)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp96' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp96, 2010)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp96' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp96, 2011)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp96' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp96, 2012)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp96' not found
</pre></div></div></div>


<b>1997 Garden, 2004-2012:</b>
<div class="chunk" id="unnamed-chunk-5"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp97, 2004)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp97, 2005)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp97, 2006)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp97, 2007)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp97, 2008)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp97, 2009)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp97, 2010)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp97, 2011)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp97, 2012)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div></div></div>


<b>1999 Garden, 2004-2012:</b>
<div class="chunk" id="unnamed-chunk-6"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp99, 2004)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp99' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp99, 2005)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp99' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp99, 2006)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp99' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp99, 2007)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp99' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp99, 2008)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp99' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp99, 2009)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp99' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp99, 2010)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp99' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp99, 2011)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp99' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">lookAtAphids</span>(pp99, 2012)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp99' not found
</pre></div></div></div>


<b>Next step: analyze aphid abundance as a function of size, location, measure date, and population. Strategy for model selection: </b>
<p>1. Remove factors one at a time and test against larger model with an ANOVA</p>
<p>2. Remove the factor that produces the largest p-value when removed from the model. </p>
<p>3. Repeat until all factors have been removed. </p>

<p>Start with the 1996 garden in 2004</p>

<div class="chunk" id="unnamed-chunk-7"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment"># look at differences by measuredate</span>
ss &lt;- pp96[pp96$measureYr == 2004, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp96' not found
</pre></div><div class="source"><pre class="knitr r"># <span class="functioncall">str</span>(ss)
<span class="functioncall">table</span>(ss$measureDt2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$date &lt;- <span class="functioncall">factor</span>(ss$measureDt2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># these dates are within a week of each other--leave them all <span class="keyword">in</span> for now</span>
zz &lt;- <span class="functioncall">tapply</span>(ss$aphids2, <span class="functioncall">list</span>(ss$aphids2, ss$date), length)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">zz[<span class="functioncall">is.na</span>(zz)] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">barplot</span>(zz)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># no obvious difference</span>
ss$lfClass &lt;- <span class="string">""</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$basalLfCt &gt;= 6, <span class="string">"lfClass"</span>] &lt;- <span class="string">"&gt;6"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$basalLfCt &lt;= 5, <span class="string">"lfClass"</span>] &lt;- <span class="string">"1-5"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$Status == <span class="string">"flowering"</span>, <span class="string">"lfClass"</span>] &lt;- <span class="string">"flowering"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$lfClass &lt;- <span class="functioncall">factor</span>(ss$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-5"</span>, <span class="string">"&gt;6"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$lfClass, ss$siteOfOriginPedigree)  #look at distribution of plant sizes/status among pops
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"># exclude <span class="functioncall">tower</span> (only 1 plant)
ss &lt;- ss[ss$siteOfOriginPedigree != <span class="string">"tower"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(ss$siteOfOriginPedigree, levels = <span class="functioncall">unique</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">

ss$aphids2 &lt;- <span class="functioncall">ordered</span>(ss$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># keep row and position as numeric</span>
<span class="functioncall">library</span>(MASS)
a6 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass:siteOfOriginPedigree + lfClass + siteOfOriginPedigree + 
    row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">a5.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ siteOfOriginPedigree + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">a4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a4.1, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.1, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">a2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.1, a2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">polr</span>(aphids2 ~ 1, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># examine best model:</span>
best &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">(pb &lt;- <span class="functioncall">profile</span>(best))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># I don't know what the profile tells you.</span>
<span class="functioncall">plot</span>(pb)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pb' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># Here's my guess: I think the pairs plot tells you whether factor levels</span>
<span class="comment"># have similar variance--If the red and green lines line up, the levels</span>
<span class="comment"># have similar variance.</span>
<span class="functioncall">pairs</span>(pb)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pb' not found
</pre></div><div class="source"><pre class="knitr r">
## use goodness of fit <span class="functioncall">test</span> (<span class="keyword">if</span> p val &gt;0.05, model is a good fit)
<span class="functioncall">pchisq</span>(<span class="functioncall">deviance</span>(best), <span class="functioncall">df.residual</span>(best))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">
# compare predicted abundances to actual <span class="functioncall">abundances</span> (by size class on one
<span class="comment"># date)</span>
newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="functioncall">c</span>(<span class="string">"1-5"</span>, <span class="string">"&gt;6"</span>, <span class="string">"flowering"</span>), date = <span class="string">"2004-08-07"</span>)
pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"prob"</span>, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">obs &lt;- <span class="functioncall">tapply</span>(ss$lfClass, <span class="functioncall">list</span>(ss$lfClass, ss$aphids2), length)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">(obs &lt;- obs/<span class="functioncall">apply</span>(obs, 1, sum))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 2))
<span class="functioncall">barplot</span>(pred, beside = T)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"topleft"</span>, legend = <span class="string">"pred."</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">barplot</span>(obs, beside = T)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"topleft"</span>, legend = <span class="string">"obs"</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))

<span class="comment"># it looks pretty good.</span>
</pre></div></div></div>


<b>Next: compare results of polr with a glm binomial of aphid presence/absence (1996 garden, 2004):</b>
<div class="chunk" id="unnamed-chunk-8"><div class="rcode"><div class="source"><pre class="knitr r">ss$aphidsPresent &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 != <span class="string">"0"</span>, <span class="string">"aphidsPresent"</span>] &lt;- 1
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
a6 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + 
    lfClass + row + pos + date, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"># <span class="functioncall">summary</span>(a6)
a5 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + pos + date, 
    family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">a5.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ +lfClass + row + pos + date, family = binomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + row + pos + date, family = binomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + pos + date, family = binomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + date, family = binomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + pos, family = binomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">
a4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + pos + date, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ +row + pos + date, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + pos + date, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + date, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + pos, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.1, a4, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + pos, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ +row + pos, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + pos, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.1, a3, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + pos, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ pos, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.1, a2, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ 1, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6, test = <span class="string">"Chi"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># evaluate best model:</span>
best &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass, family = binomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">summary</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(2, 2))
<span class="functioncall">plot</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))
<span class="comment"># doesn't look great</span>
</pre></div></div></div>



How about categories of low vs. high abundance?
<div class="chunk" id="unnamed-chunk-9"><div class="rcode"><div class="source"><pre class="knitr r">ss$aphidLH &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>), <span class="string">"aphidLH"</span>] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), <span class="string">"aphidLH"</span>] &lt;- 1
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
a6 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + 
    row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"># <span class="functioncall">summary</span>(a6) overdispersion--use quasibinomial
a5 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">a5.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ +lfClass + row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">
a4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a4.1, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + +date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ row + +date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + +date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a3.1, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.1, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">glm</span>(aphidLH ~ 1, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># evaluate best model:</span>
best &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">summary</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(2, 2))
<span class="functioncall">plot</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))
</pre></div></div></div>


<p><a name=9604sum><b>Summary for 1996 garden, 2004, 3 types of models:</b></a></p>
<p><b>1. POLR</b></p>
The best model included size/status (p=0.000028) and measure date (p=0.025). Maternal population did not contribute significantly to model variance (p=0.78). Out of the three models, the POLR seemed to be the most informative and the best fit for the data.
<p></p>
<p>2. GLM binomial of aphid presence/absence:</p>
<p> The test of aphid presence/absence did not detect differences based on date (p=0.51585) and detected a weaker effect of plant size (p=0.076). Similar to the POLR, maternal population did not matter (p=0.90757). Based on the model checking, this model may not be a good fit for the data.</p>
<p></p>
<p>3. GLM quasibinomial of low (1-10) vs high (>10) aphid abundance:</p>
 Plant size/status was the most important factor (p=0.00113), followed by date, which was not significant (p=0.111).Maternal population was not significant (p=0.459). The qualitative result is more similar to the POLR when I use high and low aphid abundance (0-10 and >10) instead of presence/absence.  
</p>
<p><b>Now try the 1997 garden in 2004</b>
</p>

<div class="chunk" id="unnamed-chunk-10"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment"># look at differences my measuredate</span>
ss &lt;- pp97[pp97$measureYr == 2004, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$measureDt2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$date &lt;- <span class="functioncall">factor</span>(ss$measureDt2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># these dates are within a week of each other--leave them all <span class="keyword">in</span> for now</span>
zz &lt;- <span class="functioncall">tapply</span>(ss$aphids2, <span class="functioncall">list</span>(ss$aphids2, ss$date), length)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">zz[<span class="functioncall">is.na</span>(zz)] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">barplot</span>(zz)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># no obvious difference</span>
<span class="functioncall">table</span>(ss[ss$Status == <span class="string">"basal"</span>, <span class="string">"basalLfCt"</span>])
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">sum</span>(ss[ss$Status == <span class="string">"basal"</span>, <span class="string">"basalLfCt"</span>] &lt;= 3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">sum</span>(ss[ss$Status == <span class="string">"basal"</span>, <span class="string">"basalLfCt"</span>] &gt;= 4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
ss$lfClass &lt;- <span class="string">""</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$basalLfCt &gt;= 4, <span class="string">"lfClass"</span>] &lt;- <span class="string">"&gt;3"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$basalLfCt &lt;= 3, <span class="string">"lfClass"</span>] &lt;- <span class="string">"1-3"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$Status == <span class="string">"flowering"</span>, <span class="string">"lfClass"</span>] &lt;- <span class="string">"flowering"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$lfClass &lt;- <span class="functioncall">factor</span>(ss$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-3"</span>, <span class="string">"&gt;3"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">(uu &lt;- <span class="functioncall">table</span>(ss$lfClass, ss$siteOfOriginPedigree))  #look at distribution of plant sizes/status among pops
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">apply</span>(uu, 2, sum)  #exclude sites with &lt;10 plants
</pre></div><div class="error"><pre class="knitr r">## Error: object 'uu' not found
</pre></div><div class="source"><pre class="knitr r">
ss &lt;- ss[!ss$siteOfOriginPedigree %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"BTG"</span>, <span class="string">"TH"</span>), ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(ss$siteOfOriginPedigree, levels = <span class="functioncall">c</span>(<span class="string">"gc"</span>, 
    <span class="string">"ri"</span>, <span class="string">"kj"</span>, <span class="string">"aa"</span>, <span class="string">"mapp"</span>, <span class="string">"alf"</span>, <span class="string">"tower"</span>, <span class="string">"nwlf"</span>, <span class="string">"lc"</span>, <span class="string">"ness"</span>, <span class="string">"lf"</span>, <span class="string">"spp"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">table</span>(ss$siteOfOriginPedigree)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># make categories <span class="keyword">for</span> plant size and status:</span>

ss$aphids2 &lt;- <span class="functioncall">ordered</span>(ss$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$lfClass, ss$siteOfOriginPedigree)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$aphids2, ss$siteOfOriginPedigree)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># keep row and position as numeric</span>
<span class="functioncall">library</span>(MASS)
a6 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass:siteOfOriginPedigree + lfClass + siteOfOriginPedigree + 
    row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment">## The error message probably means I shouldn't use the interaction</span>
<span class="comment">## between lfClass and siteOfOriginPedigree</span>
a5.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ siteOfOriginPedigree + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">a4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a4.1, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.1, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a2.1, a2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">polr</span>(aphids2 ~ 1, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment">## evaluate model:</span>
best &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass * siteOfOriginPedigree + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># There are too many factor levels <span class="keyword">in</span> the predictors to visualize the</span>
# model <span class="keyword">in</span> this way: (pb &lt;- <span class="functioncall">profile</span>(best)) <span class="functioncall">plot</span>(pb) <span class="functioncall">pairs</span>(pb)

## use goodness of fit <span class="functioncall">test</span> (<span class="keyword">if</span> p val &gt;0.05, model is a good fit)
<span class="functioncall">pchisq</span>(<span class="functioncall">deviance</span>(best), <span class="functioncall">df.residual</span>(best))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># compare predicted abundances to actual abundances <span class="keyword">for</span> a typical</span>
# <span class="functioncall">individual</span> (modal date and size class <span class="keyword">in</span> median location)
<span class="functioncall">table</span>(ss$lfClass)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$date)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="string">"&gt;3"</span>, date = <span class="string">"2004-08-08"</span>, pos = <span class="functioncall">median</span>(ss$pos), 
    row = <span class="functioncall">median</span>(ss$row), siteOfOriginPedigree = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"prob"</span>, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">
exp &lt;- <span class="functioncall">data.frame</span>(fit = <span class="functioncall">c</span>(pred[, 1], pred[, 2], pred[, 3], pred[, 4]), siteOfOriginPedigree = <span class="functioncall">rep</span>(<span class="functioncall">levels</span>(ss$siteOfOriginPedigree), 
    4), aphids2 &lt;- <span class="functioncall">rep</span>(<span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), each = 12))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">exp$aphids2 &lt;- <span class="functioncall">factor</span>(exp$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"&gt;80"</span>, <span class="string">"11-80"</span>, <span class="string">"1-10"</span>, <span class="string">"0"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">exp$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(exp$siteOfOriginPedigree, levels = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">obs &lt;- <span class="functioncall">tapply</span>(ss$siteOfOriginPedigree, <span class="functioncall">list</span>(ss$siteOfOriginPedigree, ss$aphids2), 
    length)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">obs[<span class="functioncall">is.na</span>(obs)] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r">obs &lt;- obs/<span class="functioncall">apply</span>(obs, 1, sum)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r">obs1 &lt;- <span class="functioncall">data.frame</span>(fit = <span class="functioncall">c</span>(obs[, 1], obs[, 2], obs[, 3], obs[, 4]), aphids2 = <span class="functioncall">rep</span>(<span class="functioncall">c</span>(<span class="string">"0"</span>, 
    <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), each = 12), siteOfOriginPedigree = <span class="functioncall">factor</span>(<span class="functioncall">levels</span>(ss$siteOfOriginPedigree), 
    levels = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree)))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r">obs1$aphids2 &lt;- <span class="functioncall">factor</span>(obs1$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"&gt;80"</span>, <span class="string">"11-80"</span>, <span class="string">"1-10"</span>, <span class="string">"0"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs1' not found
</pre></div><div class="source"><pre class="knitr r">obs1
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs1' not found
</pre></div><div class="source"><pre class="knitr r">zz &lt;- <span class="functioncall">tapply</span>(exp$fit, <span class="functioncall">list</span>(exp$aphids2, exp$siteOfOriginPedigree), mean)
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">
zz1 &lt;- <span class="functioncall">tapply</span>(obs1$fit, <span class="functioncall">list</span>(obs1$aphids2, obs1$siteOfOriginPedigree), mean)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs1' not found
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-11"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 2))
bp &lt;- <span class="functioncall">barplot</span>(zz)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.97, labels = <span class="functioncall">table</span>(ss$siteOfOriginPedigree), col = <span class="string">"red"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"center"</span>, legend = <span class="string">"pred."</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(zz1)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.97, labels = <span class="functioncall">table</span>(ss$siteOfOriginPedigree), col = <span class="string">"red"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"center"</span>, legend = <span class="string">"obs."</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))

<span class="comment"># it looks pretty good.</span>
</pre></div></div></div>


Compare results to binomial glm with aphid presence/absence:
<div class="chunk" id="unnamed-chunk-12"><div class="rcode"><div class="source"><pre class="knitr r">ss$aphidsPresent &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 != <span class="string">"0"</span>, <span class="string">"aphidsPresent"</span>] &lt;- 1
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
a6 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + 
    lfClass + row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"># <span class="functioncall">summary</span>(a6) overdispersion, use quasibinomial
a5 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + pos + date, 
    family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">a5.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ +lfClass + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">
a4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.1, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a3.1, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.1, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ 1, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># evaluate best model:</span>
best &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass * siteOfOriginPedigree + date + row + pos, 
    family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">summary</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(2, 2))
<span class="functioncall">plot</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))
</pre></div></div></div>



Compare results to binomial glm with low( 0-10) vs high (>10) aphid abundance:
<div class="chunk" id="unnamed-chunk-13"><div class="rcode"><div class="source"><pre class="knitr r">
ss$aphidLH &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>), <span class="string">"aphidLH"</span>] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), <span class="string">"aphidLH"</span>] &lt;- 1
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
a6 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + 
    row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"># <span class="functioncall">summary</span>(a6) overdispersion--use quasibinomial
a5 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">a5.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">
a4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">

a4.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a4.1, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a3.1, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.1, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">glm</span>(aphidLH ~ 1, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># evaluate best model:</span>
best &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree * lfClass + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">summary</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(2, 2))
<span class="functioncall">plot</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))

<span class="comment"># predict values based on typical individual, across all populations</span>
<span class="functioncall">table</span>(ss$lfClass)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$date)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">sites &lt;- <span class="functioncall">dimnames</span>(<span class="functioncall">sort</span>(<span class="functioncall">table</span>(ss$siteOfOriginPedigree)))[[1]]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">newd &lt;- <span class="functioncall">data.frame</span>(siteOfOriginPedigree = sites, lfClass = <span class="string">"&gt;3"</span>, date = <span class="string">"2004-08-08"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'sites' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"response"</span>, newdata = newd, se.fit = T)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">newd$fit &lt;- pred$fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">newd$se &lt;- pred$se.fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">
ss$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(ss$siteOfOriginPedigree, levels = sites)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">obs &lt;- <span class="functioncall">tapply</span>(ss$aphidLH, ss$siteOfOriginPedigree, mean)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># compare predicted to observed values:</span>
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-14"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 2))
bp &lt;- <span class="functioncall">barplot</span>(newd$fit, ylim = <span class="functioncall">c</span>(0, 1))
</pre></div><div class="error"><pre class="knitr r">## Error: 'height' must be a vector or a matrix
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">segments</span>(bp, newd$fit + newd$se, bp, newd$fit - newd$se)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.03, labels = sites)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(obs, ylim = <span class="functioncall">c</span>(0, 1))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.03, labels = sites)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))
</pre></div></div></div>


<p><a name=9704sum><b>Summary for 1997 garden, 2004, 3 types of models:</b></a></p>

<p><b>1. POLR of 4 categories of aphid abundance </b>(0,1-10, 11-80,>80)</p>
<p>The best model included size/status (p<0.0001),measure date (p<0.0001), position (p=0.009), and the interaction between maternal population and size/status (p=0.0025). The main effect of maternal population was not significant (p=0.126). One issue with this model is that I get an error message (fitted probabilities of 0 or 1 occurred) when I include the interaction between site and size/status. However, the model passed the goodness of fit test.  
</p>

<p><b>2. GLM quasibinomial of aphid presence/absence</b></p>
<p>The best model had the same factors as the POLR: size/class (p<0.0001), date (p=0.00012), row(0.00012), position (p=0.0008), and the interaction between size/class and maternal population (p=0.008). Similar to the POLR, the main effect of maternal population was not significant (p=0.113). The qq plot looked okay--much better than the one for the presence/absence model in the 1996 garden. </p>

<p>3. GLM quasibinomial of low (1-10) vs. high (>10) aphid abundance</p>:
Similar to the first 2 models, the best model included size/status (p<0.0001), date (p<0.0001), and the interaction between size/status and maternal population (p=0.0114). However, unlike in the other models, row was not significant (p=0.203) and position was marginally significant (p=0.08). Also, the main effect of maternal population was significant at p=0.0138. The qq plot looked decent--better than the one for presence/absence. This is probably the most suitable model for the 1997 garden in 2004.

<p>Next step: 1997 garden, 2005</p>
<div class="chunk" id="unnamed-chunk-15"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment"># look at differences by measuredate</span>
ss &lt;- pp97[pp97$measureYr == 2005, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$measureDt2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># exclude 2005-08-20</span>
ss &lt;- ss[ss$measureDt2 != <span class="string">"2005-08-29"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$date &lt;- <span class="functioncall">factor</span>(ss$measureDt2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">zz &lt;- <span class="functioncall">tapply</span>(ss$aphids2, <span class="functioncall">list</span>(ss$aphids2, ss$date), length)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">zz[<span class="functioncall">is.na</span>(zz)] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">barplot</span>(zz)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># no obvious difference</span>
<span class="functioncall">table</span>(ss[ss$Status == <span class="string">"basal"</span>, <span class="string">"basalLfCt"</span>])
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">sum</span>(ss[ss$Status == <span class="string">"basal"</span>, <span class="string">"basalLfCt"</span>] &lt;= 4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">sum</span>(ss[ss$Status == <span class="string">"basal"</span>, <span class="string">"basalLfCt"</span>] &gt;= 5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
ss$lfClass &lt;- <span class="string">""</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$basalLfCt &gt;= 5, <span class="string">"lfClass"</span>] &lt;- <span class="string">"&gt;4"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$basalLfCt &lt;= 4, <span class="string">"lfClass"</span>] &lt;- <span class="string">"1-4"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$Status == <span class="string">"flowering"</span>, <span class="string">"lfClass"</span>] &lt;- <span class="string">"flowering"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$lfClass &lt;- <span class="functioncall">factor</span>(ss$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">(uu &lt;- <span class="functioncall">table</span>(ss$lfClass, ss$siteOfOriginPedigree))  #look at distribution of plant sizes/status among pops
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">apply</span>(uu, 2, sum)  #exclude sites with &lt;10 plants, and exclude flowering plants
</pre></div><div class="error"><pre class="knitr r">## Error: object 'uu' not found
</pre></div><div class="source"><pre class="knitr r">
ss &lt;- ss[!ss$siteOfOriginPedigree %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"BTG"</span>, <span class="string">"TH"</span>), ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># exclude flowering plants:</span>
ss &lt;- ss[ss$Status != <span class="string">"flowering"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$lfClass &lt;- <span class="functioncall">factor</span>(ss$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(ss$siteOfOriginPedigree, levels = <span class="functioncall">c</span>(<span class="string">"gc"</span>, 
    <span class="string">"ri"</span>, <span class="string">"kj"</span>, <span class="string">"aa"</span>, <span class="string">"mapp"</span>, <span class="string">"alf"</span>, <span class="string">"tower"</span>, <span class="string">"nwlf"</span>, <span class="string">"lc"</span>, <span class="string">"ness"</span>, <span class="string">"lf"</span>, <span class="string">"spp"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># make categories <span class="keyword">for</span> plant size and status:</span>
ss$aphids2 &lt;- <span class="functioncall">ordered</span>(ss$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$lfClass, ss$siteOfOriginPedigree)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$aphids2, ss$siteOfOriginPedigree)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># keep row and position as numeric</span>
<span class="functioncall">library</span>(MASS)
a6 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass:siteOfOriginPedigree + lfClass + siteOfOriginPedigree + 
    row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">
a5.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ siteOfOriginPedigree + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">a4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ siteOfOriginPedigree + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.1, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a3.1, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a2.1, a2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">polr</span>(aphids2 ~ 1, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-16"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment">## evaluate model:</span>
best &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># There are too many factor levels <span class="keyword">in</span> the predictors to visualize the</span>
<span class="comment"># model <span class="keyword">in</span> this way:</span>
pb &lt;- <span class="functioncall">profile</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">
# <span class="functioncall">plot</span>(pb)
<span class="functioncall">pairs</span>(pb)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pb' not found
</pre></div><div class="source"><pre class="knitr r">
## use goodness of fit <span class="functioncall">test</span> (<span class="keyword">if</span> p val &gt;0.05, model is a good fit)
<span class="functioncall">pchisq</span>(<span class="functioncall">deviance</span>(best), <span class="functioncall">df.residual</span>(best))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-17"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment"># compare predicted abundances to actual abundances <span class="keyword">for</span> a typical</span>
# <span class="functioncall">individual</span> (modal date and size class <span class="keyword">in</span> median location)
<span class="functioncall">table</span>(ss$lfClass)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$date)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="string">"&gt;4"</span>, date = <span class="string">"2005-08-14"</span>, pos = <span class="functioncall">median</span>(ss$pos), 
    row = <span class="functioncall">median</span>(ss$row), siteOfOriginPedigree = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"prob"</span>, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">exp &lt;- <span class="functioncall">data.frame</span>(fit = <span class="functioncall">c</span>(pred[, 1], pred[, 2], pred[, 3], pred[, 4]), siteOfOriginPedigree = <span class="functioncall">rep</span>(<span class="functioncall">levels</span>(ss$siteOfOriginPedigree), 
    4), aphids2 &lt;- <span class="functioncall">rep</span>(<span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), each = 12))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">exp$aphids2 &lt;- <span class="functioncall">factor</span>(exp$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"&gt;80"</span>, <span class="string">"11-80"</span>, <span class="string">"1-10"</span>, <span class="string">"0"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">exp$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(exp$siteOfOriginPedigree, levels = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">obs &lt;- <span class="functioncall">tapply</span>(ss$siteOfOriginPedigree, <span class="functioncall">list</span>(ss$siteOfOriginPedigree, ss$aphids2), 
    length)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">obs[<span class="functioncall">is.na</span>(obs)] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r">obs &lt;- obs/<span class="functioncall">apply</span>(obs, 1, sum)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r">
obs1 &lt;- <span class="functioncall">data.frame</span>(fit = <span class="functioncall">c</span>(obs[, 1], obs[, 2], obs[, 3], obs[, 4]), aphids2 = <span class="functioncall">rep</span>(<span class="functioncall">c</span>(<span class="string">"0"</span>, 
    <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), each = 12), siteOfOriginPedigree = <span class="functioncall">factor</span>(<span class="functioncall">levels</span>(ss$siteOfOriginPedigree), 
    levels = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree)))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r">obs1$aphids2 &lt;- <span class="functioncall">factor</span>(obs1$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"&gt;80"</span>, <span class="string">"11-80"</span>, <span class="string">"1-10"</span>, <span class="string">"0"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs1' not found
</pre></div><div class="source"><pre class="knitr r">obs1
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs1' not found
</pre></div><div class="source"><pre class="knitr r">
zz &lt;- <span class="functioncall">tapply</span>(exp$fit, <span class="functioncall">list</span>(exp$aphids2, exp$siteOfOriginPedigree), mean)
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">zz1 &lt;- <span class="functioncall">tapply</span>(obs1$fit, <span class="functioncall">list</span>(obs1$aphids2, obs1$siteOfOriginPedigree), mean)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs1' not found
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-18"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 2))
bp &lt;- <span class="functioncall">barplot</span>(zz)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.97, labels = <span class="functioncall">table</span>(ss$siteOfOriginPedigree), col = <span class="string">"red"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"center"</span>, legend = <span class="string">"pred."</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(zz1)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.97, labels = <span class="functioncall">table</span>(ss$siteOfOriginPedigree), col = <span class="string">"red"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"center"</span>, legend = <span class="string">"obs."</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))

<span class="comment"># it looks pretty good.</span>
</pre></div></div></div>


Compare results to binomial glm with aphid presence/absence:
<div class="chunk" id="unnamed-chunk-19"><div class="rcode"><div class="source"><pre class="knitr r">ss$aphidsPresent &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 != <span class="string">"0"</span>, <span class="string">"aphidsPresent"</span>] &lt;- 1
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
a6 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + 
    lfClass + row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"># <span class="functioncall">summary</span>(a6) overdispersion, use quasibinomial
a5 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + pos + date, 
    family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">a5.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ +lfClass + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">
a4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.1, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a3.1, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.1, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ 1, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># evaluate best model:</span>
best &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + date + row, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">summary</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(2, 2))
<span class="functioncall">plot</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))

<span class="comment"># looks okay</span>
</pre></div></div></div>



Compare results to binomial glm with low( 0-10) vs high (>10) aphid abundance:
<div class="chunk" id="unnamed-chunk-20"><div class="rcode"><div class="source"><pre class="knitr r">
ss$aphidLH &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>), <span class="string">"aphidLH"</span>] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), <span class="string">"aphidLH"</span>] &lt;- 1
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
a6 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + 
    row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"># <span class="functioncall">summary</span>(a6) overdispersion--use quasibinomial
a5 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">a5.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">
a4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a4.1, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a3.1, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.1, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">glm</span>(aphidLH ~ 1, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># evaluate best model:</span>
best &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">summary</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(2, 2))
<span class="functioncall">plot</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))

<span class="comment"># predict values based on typical individual, across all populations</span>
<span class="comment"># (modal measure date and size, median location)</span>
<span class="functioncall">table</span>(ss$lfClass)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$date)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">sites &lt;- <span class="functioncall">levels</span>(ss$siteOfOriginPedigree)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">newd &lt;- <span class="functioncall">data.frame</span>(siteOfOriginPedigree = sites, lfClass = <span class="string">"&gt;4"</span>, date = <span class="string">"2005-08-14"</span>, 
    row = <span class="functioncall">median</span>(ss$row))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'sites' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"response"</span>, newdata = newd, se.fit = T)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">newd$fit &lt;- pred$fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">newd$se &lt;- pred$se.fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">
obs &lt;- <span class="functioncall">tapply</span>(ss$aphidLH, ss$siteOfOriginPedigree, mean)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># compare predicted to observed values:</span>
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-21"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 2))
bp &lt;- <span class="functioncall">barplot</span>(newd$fit, ylim = <span class="functioncall">c</span>(0, 1), ylab = <span class="string">"prop of plants with &gt;10 <span class="functioncall">aphids</span> (fitted)"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: 'height' must be a vector or a matrix
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">segments</span>(bp, newd$fit + newd$se, bp, newd$fit - newd$se)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.03, labels = sites)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.1, labels = <span class="functioncall">table</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(obs, ylim = <span class="functioncall">c</span>(0, 1), ylab = <span class="string">"prop of plants with &gt;10 <span class="functioncall">aphids</span> (obs.)"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.03, labels = sites)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.1, labels = <span class="functioncall">table</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"topright"</span>, legend = <span class="string">"1997 garden, 2005"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))
</pre></div></div></div>


<b>Summary for 1997 garden, 2005:</b>
<p><a name=9705sum><b>Summary for 1997 garden, 2005, 3 types of models:</b></a></p>

<p>I excluded flowering plants because there were so few. The categories of plant size were 1-4 and >4 basal leaves.</p>

<p><b>1. POLR:</b></p>
Maternal population was a marginally significant predictor of aphid abundance (p=0.053). Other significant predictors were plant size (1-4 vs. >4 lvs))p<0.0001), measure date (p<0.0001), and row (o=0.0053).
<p></p>

<p><b>2. GLM quasibinomial, presence/absence:</b></p>
Maternal population was not a significant predictor of the presence of aphids (p=0.24). The best model included plant size (p<0.0001), measure date(p=0.00058), and row(p=0.00077).
<p></p>
<p><b>3. GLM binomial, low(1-10) vs high (>10) aphid abundance:</b> </p>
Maternal population was marginally significant (p=0.0375). Similar to the first two models, plant size (p<0.0001), measure date (p=0.00037), and row (p=0.004) were significant co-variates.


<p><b>Next step: 1997 garden in 2006</b></p>

<div class="chunk" id="unnamed-chunk-22"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment"># look at differences by measuredate</span>
ss &lt;- pp97[pp97$measureYr == 2006, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$measureDt2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># exclude 2006-08-03 and 2006-08-05</span>
ss &lt;- ss[ss$measureDt2 != <span class="string">"2006-08-03"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss &lt;- ss[ss$measureDt2 != <span class="string">"2006-08-05"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
ss$date &lt;- <span class="functioncall">factor</span>(ss$measureDt2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">zz &lt;- <span class="functioncall">tapply</span>(ss$aphids2, <span class="functioncall">list</span>(ss$aphids2, ss$date), length)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">zz[<span class="functioncall">is.na</span>(zz)] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">barplot</span>(zz)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># no obvious difference</span>
<span class="functioncall">table</span>(ss[ss$Status == <span class="string">"basal"</span>, <span class="string">"basalLfCt"</span>])
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">sum</span>(ss[ss$Status == <span class="string">"basal"</span>, <span class="string">"basalLfCt"</span>] &lt;= 4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">sum</span>(ss[ss$Status == <span class="string">"basal"</span>, <span class="string">"basalLfCt"</span>] &gt;= 5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
ss$lfClass &lt;- <span class="string">""</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$basalLfCt &gt;= 5, <span class="string">"lfClass"</span>] &lt;- <span class="string">"&gt;4"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$basalLfCt &lt;= 4, <span class="string">"lfClass"</span>] &lt;- <span class="string">"1-4"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$Status == <span class="string">"flowering"</span>, <span class="string">"lfClass"</span>] &lt;- <span class="string">"flowering"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$lfClass &lt;- <span class="functioncall">factor</span>(ss$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">(uu &lt;- <span class="functioncall">table</span>(ss$lfClass, ss$siteOfOriginPedigree))  #look at distribution of plant sizes/status among pops
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">apply</span>(uu, 2, sum)  #exclude sites with &lt;10 plants, and keep <span class="keyword">in</span> flowering plants
</pre></div><div class="error"><pre class="knitr r">## Error: object 'uu' not found
</pre></div><div class="source"><pre class="knitr r">
ss &lt;- ss[!ss$siteOfOriginPedigree %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"BTG"</span>, <span class="string">"TH"</span>), ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(ss$siteOfOriginPedigree, levels = <span class="functioncall">c</span>(<span class="string">"gc"</span>, 
    <span class="string">"ri"</span>, <span class="string">"kj"</span>, <span class="string">"aa"</span>, <span class="string">"mapp"</span>, <span class="string">"alf"</span>, <span class="string">"tower"</span>, <span class="string">"nwlf"</span>, <span class="string">"lc"</span>, <span class="string">"ness"</span>, <span class="string">"lf"</span>, <span class="string">"spp"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># make categories <span class="keyword">for</span> plant size and status:</span>
ss$aphids2 &lt;- <span class="functioncall">ordered</span>(ss$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$lfClass, ss$siteOfOriginPedigree)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$aphids2, ss$siteOfOriginPedigree)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># keep row and position as numeric</span>
<span class="functioncall">library</span>(MASS)
a6 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass:siteOfOriginPedigree + lfClass + siteOfOriginPedigree + 
    row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">
a5.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ siteOfOriginPedigree + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">a4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a4.1, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ row + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a3.1, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a2.1, a2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">polr</span>(aphids2 ~ 1, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-23"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment">## evaluate model:</span>
best &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
pb &lt;- <span class="functioncall">profile</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">plot</span>(pb)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pb' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">pairs</span>(pb)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pb' not found
</pre></div><div class="source"><pre class="knitr r">
## use goodness of fit <span class="functioncall">test</span> (<span class="keyword">if</span> p val &gt;0.05, model is a good fit)
<span class="functioncall">pchisq</span>(<span class="functioncall">deviance</span>(best), <span class="functioncall">df.residual</span>(best))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-24"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment"># compare predicted abundances to actual abundances <span class="keyword">for</span> a typical</span>
# <span class="functioncall">individual</span> (modal date and size class <span class="keyword">in</span> median location)
<span class="functioncall">table</span>(ss$lfClass)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$date)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>), pos = <span class="functioncall">median</span>(ss$pos), 
    row = <span class="functioncall">median</span>(ss$row))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"prob"</span>, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">exp &lt;- <span class="functioncall">data.frame</span>(fit = <span class="functioncall">c</span>(pred[, 1], pred[, 2], pred[, 3], pred[, 4]), lfClass = <span class="functioncall">rep</span>(<span class="functioncall">levels</span>(ss$lfClass), 
    4), aphids2 = <span class="functioncall">rep</span>(<span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), each = 3))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">exp$aphids2 &lt;- <span class="functioncall">factor</span>(exp$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"&gt;80"</span>, <span class="string">"11-80"</span>, <span class="string">"1-10"</span>, <span class="string">"0"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">exp$lfClass &lt;- <span class="functioncall">factor</span>(exp$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">
obs &lt;- <span class="functioncall">tapply</span>(ss$lfClass, <span class="functioncall">list</span>(ss$lfClass, ss$aphids2), length)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">obs[<span class="functioncall">is.na</span>(obs)] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r">obs &lt;- obs/<span class="functioncall">apply</span>(obs, 1, sum)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r">
obs1 &lt;- <span class="functioncall">data.frame</span>(fit = <span class="functioncall">c</span>(obs[, 1], obs[, 2], obs[, 3], obs[, 4]), aphids2 = <span class="functioncall">rep</span>(<span class="functioncall">c</span>(<span class="string">"0"</span>, 
    <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), each = 3), lfClass = <span class="functioncall">rep</span>(<span class="functioncall">levels</span>(ss$lfClass), 4))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r">obs1$aphids2 &lt;- <span class="functioncall">factor</span>(obs1$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"&gt;80"</span>, <span class="string">"11-80"</span>, <span class="string">"1-10"</span>, <span class="string">"0"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs1' not found
</pre></div><div class="source"><pre class="knitr r">obs1$lfClass &lt;- <span class="functioncall">factor</span>(obs1$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs1' not found
</pre></div><div class="source"><pre class="knitr r">zz &lt;- <span class="functioncall">tapply</span>(exp$fit, <span class="functioncall">list</span>(exp$aphids2, exp$lfClass), mean)
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">zz1 &lt;- <span class="functioncall">tapply</span>(obs1$fit, <span class="functioncall">list</span>(obs1$aphids2, obs1$lfClass), mean)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs1' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 2))
bp &lt;- <span class="functioncall">barplot</span>(zz)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.97, labels = <span class="functioncall">table</span>(ss$lfClass), col = <span class="string">"red"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"center"</span>, legend = <span class="string">"pred."</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(zz1)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.97, labels = <span class="functioncall">table</span>(ss$lfClass), col = <span class="string">"red"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"center"</span>, legend = <span class="string">"obs."</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))

<span class="comment"># it looks pretty good.</span>
</pre></div></div></div>


Compare results to binomial glm with aphid presence/absence:
<div class="chunk" id="unnamed-chunk-25"><div class="rcode"><div class="source"><pre class="knitr r">ss$aphidsPresent &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 != <span class="string">"0"</span>, <span class="string">"aphidsPresent"</span>] &lt;- 1
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
a6 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + 
    lfClass + row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"># <span class="functioncall">summary</span>(a6) overdispersion, use quasibinomial
a5 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + pos + date, 
    family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">a5.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ +lfClass + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">
a4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + row + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a4.1, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ row + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a3.1, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.1, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ 1, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># evaluate best model:</span>
best &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">summary</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(2, 2))
<span class="functioncall">plot</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))

<span class="comment"># look at fitted model:</span>
newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>), pos = <span class="functioncall">median</span>(ss$pos), 
    row = <span class="functioncall">median</span>(ss$row))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"response"</span>, se.fit = T, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">newd$fit &lt;- pred$fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">newd$se &lt;- pred$se.fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 2))
bp &lt;- <span class="functioncall">barplot</span>(newd$fit, ylim = <span class="functioncall">c</span>(0, 1), ylab = <span class="string">"prop. of plants with <span class="functioncall">aphids</span> (pred)"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: 'height' must be a vector or a matrix
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">axis</span>(1, at = bp, labels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">segments</span>(bp, newd$fit + newd$se, bp, newd$fit - newd$se)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(<span class="functioncall">tapply</span>(ss$aphidsPresent, ss$lfClass, mean), ylim = <span class="functioncall">c</span>(0, 1), ylab = <span class="string">"prop. of plants with <span class="functioncall">aphids</span> (obs)"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))
<span class="comment"># looks okay</span>
</pre></div></div></div>



Compare results to binomial glm with low( 0-10) vs high (>10) aphid abundance:
<div class="chunk" id="unnamed-chunk-26"><div class="rcode"><div class="source"><pre class="knitr r">
ss$aphidLH &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>), <span class="string">"aphidLH"</span>] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), <span class="string">"aphidLH"</span>] &lt;- 1
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
a6 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + 
    row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"># <span class="functioncall">summary</span>(a6) overdispersion--use quasibinomial
a5 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">a5.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">
a4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a4.1, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ row + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a3.1, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.1, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">glm</span>(aphidLH ~ 1, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># evaluate best model:</span>
best &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + pos, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">summary</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(2, 2))
<span class="functioncall">plot</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))

<span class="comment"># not great, but okay--qualitative results are the same as other models</span>
<span class="comment"># predict values based on typical individual, across all populations</span>
<span class="comment"># (modal measure date and size, median location)</span>

<span class="comment"># compare predicted to observed values:</span>
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-27"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment"># look at fitted model:</span>
newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>), pos = <span class="functioncall">median</span>(ss$pos), 
    row = <span class="functioncall">median</span>(ss$row))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"response"</span>, se.fit = T, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">newd$fit &lt;- pred$fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">newd$se &lt;- pred$se.fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 2))
bp &lt;- <span class="functioncall">barplot</span>(newd$fit, ylim = <span class="functioncall">c</span>(0, 1), ylab = <span class="string">"prop. of plants with &gt;10 <span class="functioncall">aphids</span> (pred)"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: 'height' must be a vector or a matrix
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">axis</span>(1, at = bp, labels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">segments</span>(bp, newd$fit + newd$se, bp, newd$fit - newd$se)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(<span class="functioncall">tapply</span>(ss$aphidsPresent, ss$lfClass, mean), ylim = <span class="functioncall">c</span>(0, 1), ylab = <span class="string">"prop. of plants with &gt;10 <span class="functioncall">aphids</span> (obs)"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))
</pre></div></div></div>


<p><a name=9706sum><b>Summary for 1997 garden, 2006, 3 types of models:</b></a></p>

<p>Maternal population did not contribute to aphid infestation in any of the three models (p=0.5675, polr, -=0.6768, glm presence/absence-quasibinomial, p=0.58, glm low/high). Plant size/status was the most influential factor influencing aphid infesation in all models (p<0.0001). Row and position also influenced aphid infestation in all three models (row: p<0.0001, polr, p=0.021, presence/absence, p<0.0001, low/high) (position: p<0.0001, polr, glm low/high, p=0.00024, glm presence/absence). Measuring date did not influence aphid infestation in any model (p=0.22, polr,p=0.711, presence/absence,p=0.091, polr low/high).</p>

<p><b>Next step: 1997 garden in 2007</b></p>

<div class="chunk" id="unnamed-chunk-28"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment"># look at differences by measuredate</span>
ss &lt;- pp97[pp97$measureYr == 2007, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$measureDt2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># exclude 2007-07-27 and 2007-08-08</span>
ss &lt;- ss[ss$measureDt2 != <span class="string">"2007-07-27"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss &lt;- ss[ss$measureDt2 != <span class="string">"2007-08-08"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
ss$date &lt;- <span class="functioncall">factor</span>(ss$measureDt2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">zz &lt;- <span class="functioncall">tapply</span>(ss$aphids2, <span class="functioncall">list</span>(ss$aphids2, ss$date), length)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">zz[<span class="functioncall">is.na</span>(zz)] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">barplot</span>(zz)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># no obvious difference</span>
<span class="functioncall">table</span>(ss[ss$Status == <span class="string">"basal"</span>, <span class="string">"basalLfCt"</span>])
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">sum</span>(ss[ss$Status == <span class="string">"basal"</span>, <span class="string">"basalLfCt"</span>] &lt;= 4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">sum</span>(ss[ss$Status == <span class="string">"basal"</span>, <span class="string">"basalLfCt"</span>] &gt;= 5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
ss$lfClass &lt;- <span class="string">""</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$basalLfCt &gt;= 5, <span class="string">"lfClass"</span>] &lt;- <span class="string">"&gt;4"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$basalLfCt &lt;= 4, <span class="string">"lfClass"</span>] &lt;- <span class="string">"1-4"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$Status == <span class="string">"flowering"</span>, <span class="string">"lfClass"</span>] &lt;- <span class="string">"flowering"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$lfClass &lt;- <span class="functioncall">factor</span>(ss$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">(uu &lt;- <span class="functioncall">table</span>(ss$lfClass, ss$siteOfOriginPedigree))  #look at distribution of plant sizes/status among pops
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">apply</span>(uu, 2, sum)  #exclude sites with &lt;10 plants, and keep <span class="keyword">in</span> flowering plants
</pre></div><div class="error"><pre class="knitr r">## Error: object 'uu' not found
</pre></div><div class="source"><pre class="knitr r">
ss &lt;- ss[!ss$siteOfOriginPedigree %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"BTG"</span>, <span class="string">"TH"</span>), ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(ss$siteOfOriginPedigree, levels = <span class="functioncall">c</span>(<span class="string">"gc"</span>, 
    <span class="string">"ri"</span>, <span class="string">"kj"</span>, <span class="string">"aa"</span>, <span class="string">"mapp"</span>, <span class="string">"alf"</span>, <span class="string">"tower"</span>, <span class="string">"nwlf"</span>, <span class="string">"lc"</span>, <span class="string">"ness"</span>, <span class="string">"lf"</span>, <span class="string">"spp"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># make categories <span class="keyword">for</span> plant size and status:</span>
ss$aphids2 &lt;- <span class="functioncall">ordered</span>(ss$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$lfClass, ss$siteOfOriginPedigree)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$aphids2, ss$siteOfOriginPedigree)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># keep row and position as numeric</span>
<span class="functioncall">library</span>(MASS)
a6 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass:siteOfOriginPedigree + lfClass + siteOfOriginPedigree + 
    row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">
a5.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ siteOfOriginPedigree + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + pos + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + pos, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">a4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ siteOfOriginPedigree + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + row + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.1, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ siteOfOriginPedigree + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a3.1, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a2.1, a2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">polr</span>(aphids2 ~ 1, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-29"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment">## evaluate model:</span>
best &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + date, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
pb &lt;- <span class="functioncall">profile</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">plot</span>(pb)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pb' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">pairs</span>(pb)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pb' not found
</pre></div><div class="source"><pre class="knitr r">
## use goodness of fit <span class="functioncall">test</span> (<span class="keyword">if</span> p val &gt;0.05, model is a good fit)
<span class="functioncall">pchisq</span>(<span class="functioncall">deviance</span>(best), <span class="functioncall">df.residual</span>(best))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-30"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment"># compare predicted abundances to actual abundances <span class="keyword">for</span> a typical</span>
# <span class="functioncall">individual</span> (modal date and size class <span class="keyword">in</span> median location)
<span class="functioncall">table</span>(ss$lfClass)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$date)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>), date = <span class="string">"2007-07-20"</span>)
pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"prob"</span>, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">exp &lt;- <span class="functioncall">data.frame</span>(fit = <span class="functioncall">c</span>(pred[, 1], pred[, 2], pred[, 3], pred[, 4]), lfClass = <span class="functioncall">rep</span>(<span class="functioncall">levels</span>(ss$lfClass), 
    4), aphids2 = <span class="functioncall">rep</span>(<span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), each = 3))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">exp$aphids2 &lt;- <span class="functioncall">factor</span>(exp$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"&gt;80"</span>, <span class="string">"11-80"</span>, <span class="string">"1-10"</span>, <span class="string">"0"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">exp$lfClass &lt;- <span class="functioncall">factor</span>(exp$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">
obs &lt;- <span class="functioncall">tapply</span>(ss$lfClass, <span class="functioncall">list</span>(ss$lfClass, ss$aphids2), length)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">obs[<span class="functioncall">is.na</span>(obs)] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r">obs &lt;- obs/<span class="functioncall">apply</span>(obs, 1, sum)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r">
obs1 &lt;- <span class="functioncall">data.frame</span>(fit = <span class="functioncall">c</span>(obs[, 1], obs[, 2], obs[, 3], obs[, 4]), aphids2 = <span class="functioncall">rep</span>(<span class="functioncall">c</span>(<span class="string">"0"</span>, 
    <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), each = 3), lfClass = <span class="functioncall">rep</span>(<span class="functioncall">levels</span>(ss$lfClass), 4))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs' not found
</pre></div><div class="source"><pre class="knitr r">obs1$aphids2 &lt;- <span class="functioncall">factor</span>(obs1$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"&gt;80"</span>, <span class="string">"11-80"</span>, <span class="string">"1-10"</span>, <span class="string">"0"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs1' not found
</pre></div><div class="source"><pre class="knitr r">obs1$lfClass &lt;- <span class="functioncall">factor</span>(obs1$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs1' not found
</pre></div><div class="source"><pre class="knitr r">zz &lt;- <span class="functioncall">tapply</span>(exp$fit, <span class="functioncall">list</span>(exp$aphids2, exp$lfClass), mean)
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">zz1 &lt;- <span class="functioncall">tapply</span>(obs1$fit, <span class="functioncall">list</span>(obs1$aphids2, obs1$lfClass), mean)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'obs1' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 2))
bp &lt;- <span class="functioncall">barplot</span>(zz)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.97, labels = <span class="functioncall">table</span>(ss$lfClass), col = <span class="string">"red"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"center"</span>, legend = <span class="string">"pred."</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(zz1)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.97, labels = <span class="functioncall">table</span>(ss$lfClass), col = <span class="string">"red"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"center"</span>, legend = <span class="string">"obs."</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))

<span class="comment"># it looks pretty good.</span>
</pre></div></div></div>


Compare results to binomial glm with aphid presence/absence:
<div class="chunk" id="unnamed-chunk-31"><div class="rcode"><div class="source"><pre class="knitr r">ss$aphidsPresent &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 != <span class="string">"0"</span>, <span class="string">"aphidsPresent"</span>] &lt;- 1
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
a6 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + 
    lfClass + row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"># <span class="functioncall">summary</span>(a6) overdispersion, use quasibinomial
a5 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + pos + date, 
    family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">a5.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ +lfClass + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">
a4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + row, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a4.1, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree + lfClass, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a3.1, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.1, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ 1, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># evaluate best model:</span>
best &lt;- <span class="functioncall">glm</span>(aphidsPresent ~ siteOfOriginPedigree * lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">summary</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(2, 2))
<span class="functioncall">plot</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))
<span class="comment"># looks pretty good</span>

<span class="comment"># look at fitted model <span class="keyword">for</span> typical individual</span>
<span class="functioncall">table</span>(ss$lfClass)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">table</span>(ss$date)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="string">"1-4"</span>, siteOfOriginPedigree = <span class="functioncall">factor</span>(<span class="functioncall">levels</span>(ss$siteOfOriginPedigree)), 
    row = <span class="functioncall">median</span>(ss$row), date = <span class="string">"2007-07-23"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"response"</span>, se.fit = T, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">newd$fit &lt;- pred$fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">newd$se &lt;- pred$se.fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-32"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 2))
bp &lt;- <span class="functioncall">barplot</span>(newd$fit, ylim = <span class="functioncall">c</span>(0, 1), ylab = <span class="string">"prop. of plants with <span class="functioncall">aphids</span> (pred)"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: 'height' must be a vector or a matrix
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"topleft"</span>, legend = <span class="string">"1-4 lvs"</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">axis</span>(1, at = bp, labels = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.03, labels = <span class="functioncall">table</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">segments</span>(bp, newd$fit + newd$se, bp, newd$fit - newd$se)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(<span class="functioncall">tapply</span>(ss$aphidsPresent, ss$siteOfOriginPedigree, mean), ylim = <span class="functioncall">c</span>(0, 
    1), ylab = <span class="string">"prop. of plants\nwith <span class="functioncall">aphids</span> (obs)"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.03, labels = <span class="functioncall">table</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))


<span class="comment"># look at fitted values <span class="keyword">for</span> big basal plants and flowering plants: big</span>
# basal <span class="functioncall">plants</span> (&gt;4 leaves)
newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="string">"&gt;4"</span>, siteOfOriginPedigree = <span class="functioncall">factor</span>(<span class="functioncall">levels</span>(ss$siteOfOriginPedigree)), 
    row = <span class="functioncall">median</span>(ss$row), date = <span class="string">"2007-07-23"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"response"</span>, se.fit = T, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">newd$fit &lt;- pred$fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">newd$se &lt;- pred$se.fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(newd$fit, ylim = <span class="functioncall">c</span>(0, 1), ylab = <span class="string">"prop. of plants with <span class="functioncall">aphids</span> (pred)"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: 'height' must be a vector or a matrix
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"topleft"</span>, legend = <span class="string">"&gt;4 lvs"</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">axis</span>(1, at = bp, labels = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.03, labels = <span class="functioncall">table</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">segments</span>(bp, newd$fit + newd$se, bp, newd$fit - newd$se)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># flowering plants</span>
newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="string">"flowering"</span>, siteOfOriginPedigree = <span class="functioncall">factor</span>(<span class="functioncall">levels</span>(ss$siteOfOriginPedigree)), 
    row = <span class="functioncall">median</span>(ss$row), date = <span class="string">"2007-07-23"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"response"</span>, se.fit = T, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">newd$fit &lt;- pred$fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">newd$se &lt;- pred$se.fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(newd$fit, ylim = <span class="functioncall">c</span>(0, 1), ylab = <span class="string">"prop. of plants with <span class="functioncall">aphids</span> (pred)"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: 'height' must be a vector or a matrix
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"topleft"</span>, legend = <span class="string">"flowering lvs"</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">axis</span>(1, at = bp, labels = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.03, labels = <span class="functioncall">table</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">segments</span>(bp, newd$fit + newd$se, bp, newd$fit - newd$se)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r">


<span class="comment"># looks okay</span>
</pre></div></div></div>



Compare results to binomial glm with low( 0-10) vs high (>10) aphid abundance:
<div class="chunk" id="unnamed-chunk-33"><div class="rcode"><div class="source"><pre class="knitr r">
ss$aphidLH &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>), <span class="string">"aphidLH"</span>] &lt;- 0
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">ss[ss$aphids2 %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), <span class="string">"aphidLH"</span>] &lt;- 1
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
a6 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree:lfClass + siteOfOriginPedigree + lfClass + 
    row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"># <span class="functioncall">summary</span>(a6) overdispersion--use quasibinomial
a5 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5' not found
</pre></div><div class="source"><pre class="knitr r">a5.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + pos + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + row + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + pos + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a5.5 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + pos, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.1, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.2, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.3, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.4, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.4' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a5.5, a5, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a5.5' not found
</pre></div><div class="source"><pre class="knitr r">
a4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + row + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + date, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a4.4 &lt;- <span class="functioncall">glm</span>(aphidLH ~ siteOfOriginPedigree + lfClass + row, family = quasibinomial, 
    data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="functioncall">anova</span>(a4.1, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.2, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.3, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.3' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a4.4, a4, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a4.4' not found
</pre></div><div class="source"><pre class="knitr r">
a3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ row + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a3.3 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + row, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.1, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.2, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a3.3, a3, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a3.3' not found
</pre></div><div class="source"><pre class="knitr r">
a2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">a2.2 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.1, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(a2.2, a2, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'a2.2' not found
</pre></div><div class="source"><pre class="knitr r">a1 &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">null &lt;- <span class="functioncall">glm</span>(aphidLH ~ 1, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">anova</span>(null, a1, a2, a3, a4, a5, a6, test = <span class="string">"F"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'null' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># evaluate best model:</span>
best &lt;- <span class="functioncall">glm</span>(aphidLH ~ lfClass + date, family = quasibinomial, data = ss)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">summary</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(2, 2))
<span class="functioncall">plot</span>(best)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))

<span class="comment"># looks okay--qualitative results are similar to POLR predict values based</span>
# on typical individual, across all <span class="functioncall">populations</span> (modal measure date and
<span class="comment"># size, median location)</span>

<span class="comment"># compare predicted to observed values:</span>
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-34"><div class="rcode"><div class="source"><pre class="knitr r"><span class="comment"># look at fitted model:</span>
<span class="functioncall">table</span>(ss$date)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>), pos = <span class="functioncall">median</span>(ss$pos), 
    row = <span class="functioncall">median</span>(ss$row), date = <span class="string">"2007-07-24"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best, type = <span class="string">"response"</span>, se.fit = T, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best' not found
</pre></div><div class="source"><pre class="knitr r">newd$fit &lt;- pred$fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">newd$se &lt;- pred$se.fit
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-35"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 2))
bp &lt;- <span class="functioncall">barplot</span>(newd$fit, ylim = <span class="functioncall">c</span>(0, 1), ylab = <span class="string">"prop. of plants with &gt;10 <span class="functioncall">aphids</span> (pred)"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: 'height' must be a vector or a matrix
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.95, <span class="functioncall">table</span>(ss$lfClass))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">axis</span>(1, at = bp, labels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">segments</span>(bp, newd$fit + newd$se, bp, newd$fit - newd$se)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(<span class="functioncall">tapply</span>(ss$aphidsPresent, ss$lfClass, mean), ylim = <span class="functioncall">c</span>(0, 1), ylab = <span class="string">"prop. of plants with &gt;10 <span class="functioncall">aphids</span> (obs)"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))
</pre></div></div></div>



<p><a name=9707sum><b>Summary for 1997 garden, 2007, 3 types of models:</b></a></p>

<p><b>POLR:</b></p>
Maternal population did not influence aphid abundance (p=0.199), nor did row (p=0.4172) or position (p=0.972). The best model included measure date (p=0.00056) and lfClass (p=0). 

<p><b>GLM quasibinomial (presence/absence).</b></p> 
Unlike the POLR, this model found a significant effect of maternal population (p=0.025) and the interaction between maternal population and size/status (p=0.045), along with a slight effect of row (p=0.05). Similar to the POLR, plant size/status (p<0.0001) and measure date (p=0.0048) were the most important factors influencing aphid infestation. Differences in the occurrence of aphids among populations were more pronounced among small basal plants (1-4 lvs) than large basal plants (>4 lvs) or flowering plants (see barplots).

<p><b>GLM quasibinomial (low/high) </b></p> 
The results were qualitatively similar to the POLR. The best model included size/status (p<0.0001) and measure date (p=0.0074). Row was marginally siginificant (p=0.089). Maternal population and position did not contribute significantly to the model (p=0.28 and p=0.51, respectively).


<p>Put 2004 and 2005 side by side for the 1997 garden--were some populations consistently less infested than others?</p>
<div class="chunk" id="unnamed-chunk-36"><div class="rcode"><div class="source"><pre class="knitr r">ss1 &lt;- pp97[pp97$measureYr == 2004, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r">ss1$date &lt;- <span class="functioncall">factor</span>(ss1$measureDt2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss1' not found
</pre></div><div class="source"><pre class="knitr r">ss1$lfClass &lt;- <span class="string">""</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss1' not found
</pre></div><div class="source"><pre class="knitr r">ss1[ss1$basalLfCt &gt;= 4, <span class="string">"lfClass"</span>] &lt;- <span class="string">"&gt;3"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss1' not found
</pre></div><div class="source"><pre class="knitr r">ss1[ss1$basalLfCt &lt;= 3, <span class="string">"lfClass"</span>] &lt;- <span class="string">"1-3"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss1' not found
</pre></div><div class="source"><pre class="knitr r">ss1[ss1$Status == <span class="string">"flowering"</span>, <span class="string">"lfClass"</span>] &lt;- <span class="string">"flowering"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss1' not found
</pre></div><div class="source"><pre class="knitr r">ss1$lfClass &lt;- <span class="functioncall">factor</span>(ss1$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-3"</span>, <span class="string">"&gt;3"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss1' not found
</pre></div><div class="source"><pre class="knitr r">ss1 &lt;- ss1[!ss1$siteOfOriginPedigree %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"BTG"</span>, <span class="string">"TH"</span>), ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss1' not found
</pre></div><div class="source"><pre class="knitr r">ss1$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(ss1$siteOfOriginPedigree, levels = <span class="functioncall">c</span>(<span class="string">"gc"</span>, 
    <span class="string">"ri"</span>, <span class="string">"kj"</span>, <span class="string">"aa"</span>, <span class="string">"mapp"</span>, <span class="string">"alf"</span>, <span class="string">"tower"</span>, <span class="string">"nwlf"</span>, <span class="string">"lc"</span>, <span class="string">"ness"</span>, <span class="string">"lf"</span>, <span class="string">"spp"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss1' not found
</pre></div><div class="source"><pre class="knitr r">ss1$aphids2 &lt;- <span class="functioncall">ordered</span>(ss1$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss1' not found
</pre></div><div class="source"><pre class="knitr r">

ss2 &lt;- pp97[pp97$measureYr == 2005, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pp97' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># exclude 2005-08-20</span>
ss2 &lt;- ss2[ss2$measureDt2 != <span class="string">"2005-08-29"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r">ss2$date &lt;- <span class="functioncall">factor</span>(ss2$measureDt2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r">ss2$lfClass &lt;- <span class="string">""</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r">ss2[ss2$basalLfCt &gt;= 5, <span class="string">"lfClass"</span>] &lt;- <span class="string">"&gt;4"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r">ss2[ss2$basalLfCt &lt;= 4, <span class="string">"lfClass"</span>] &lt;- <span class="string">"1-4"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r">ss2[ss2$Status == <span class="string">"flowering"</span>, <span class="string">"lfClass"</span>] &lt;- <span class="string">"flowering"</span>
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r">ss2$lfClass &lt;- <span class="functioncall">factor</span>(ss2$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>, <span class="string">"flowering"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r">ss2 &lt;- ss2[!ss2$siteOfOriginPedigree %<span class="keyword">in</span>% <span class="functioncall">c</span>(<span class="string">"BTG"</span>, <span class="string">"TH"</span>), ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="comment"># exclude flowering plants:</span>
ss2 &lt;- ss2[ss2$Status != <span class="string">"flowering"</span>, ]
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r">ss2$lfClass &lt;- <span class="functioncall">factor</span>(ss2$lfClass, levels = <span class="functioncall">c</span>(<span class="string">"1-4"</span>, <span class="string">"&gt;4"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r">ss2$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(ss2$siteOfOriginPedigree, levels = <span class="functioncall">c</span>(<span class="string">"gc"</span>, 
    <span class="string">"ri"</span>, <span class="string">"kj"</span>, <span class="string">"aa"</span>, <span class="string">"mapp"</span>, <span class="string">"alf"</span>, <span class="string">"tower"</span>, <span class="string">"nwlf"</span>, <span class="string">"lc"</span>, <span class="string">"ness"</span>, <span class="string">"lf"</span>, <span class="string">"spp"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r">ss2$aphids2 &lt;- <span class="functioncall">ordered</span>(ss2$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r">
<span class="comment"># 2005</span>
best04 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass * siteOfOriginPedigree + row + pos + date, 
    data = ss1)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss1' not found
</pre></div><div class="source"><pre class="knitr r">best05 &lt;- <span class="functioncall">polr</span>(aphids2 ~ lfClass + siteOfOriginPedigree + row + date, data = ss2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss2' not found
</pre></div><div class="source"><pre class="knitr r">
newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="string">"&gt;3"</span>, date = <span class="string">"2004-08-08"</span>, pos = <span class="functioncall">median</span>(ss$pos), 
    row = <span class="functioncall">median</span>(ss$row), siteOfOriginPedigree = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best04, type = <span class="string">"prob"</span>, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best04' not found
</pre></div><div class="source"><pre class="knitr r">exp &lt;- <span class="functioncall">data.frame</span>(fit = <span class="functioncall">c</span>(pred[, 1], pred[, 2], pred[, 3], pred[, 4]), siteOfOriginPedigree = <span class="functioncall">rep</span>(<span class="functioncall">levels</span>(ss$siteOfOriginPedigree), 
    4), aphids2 &lt;- <span class="functioncall">rep</span>(<span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), each = 12))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">exp$aphids2 &lt;- <span class="functioncall">factor</span>(exp$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"&gt;80"</span>, <span class="string">"11-80"</span>, <span class="string">"1-10"</span>, <span class="string">"0"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">exp$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(exp$siteOfOriginPedigree, levels = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">zz1 &lt;- <span class="functioncall">tapply</span>(exp$fit, <span class="functioncall">list</span>(exp$aphids2, exp$siteOfOriginPedigree), mean)
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">
newd &lt;- <span class="functioncall">data.frame</span>(lfClass = <span class="string">"&gt;4"</span>, date = <span class="string">"2005-08-14"</span>, pos = <span class="functioncall">median</span>(ss$pos), 
    row = <span class="functioncall">median</span>(ss$row), siteOfOriginPedigree = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'ss' not found
</pre></div><div class="source"><pre class="knitr r">pred &lt;- <span class="functioncall">predict</span>(best05, type = <span class="string">"prob"</span>, newdata = newd)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'best05' not found
</pre></div><div class="source"><pre class="knitr r">exp &lt;- <span class="functioncall">data.frame</span>(fit = <span class="functioncall">c</span>(pred[, 1], pred[, 2], pred[, 3], pred[, 4]), siteOfOriginPedigree = <span class="functioncall">rep</span>(<span class="functioncall">levels</span>(ss$siteOfOriginPedigree), 
    4), aphids2 &lt;- <span class="functioncall">rep</span>(<span class="functioncall">c</span>(<span class="string">"0"</span>, <span class="string">"1-10"</span>, <span class="string">"11-80"</span>, <span class="string">"&gt;80"</span>), each = 12))
</pre></div><div class="error"><pre class="knitr r">## Error: object 'pred' not found
</pre></div><div class="source"><pre class="knitr r">exp$aphids2 &lt;- <span class="functioncall">factor</span>(exp$aphids2, levels = <span class="functioncall">c</span>(<span class="string">"&gt;80"</span>, <span class="string">"11-80"</span>, <span class="string">"1-10"</span>, <span class="string">"0"</span>))
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">exp$siteOfOriginPedigree &lt;- <span class="functioncall">factor</span>(exp$siteOfOriginPedigree, levels = <span class="functioncall">levels</span>(ss$siteOfOriginPedigree))
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div><div class="source"><pre class="knitr r">zz2 &lt;- <span class="functioncall">tapply</span>(exp$fit, <span class="functioncall">list</span>(exp$aphids2, exp$siteOfOriginPedigree), mean)
</pre></div><div class="error"><pre class="knitr r">## Error: object of type 'builtin' is not subsettable
</pre></div></div></div>


<div class="chunk" id="unnamed-chunk-37"><div class="rcode"><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 2))
bp &lt;- <span class="functioncall">barplot</span>(zz1)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz1' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.97, labels = <span class="functioncall">table</span>(ss1$siteOfOriginPedigree), col = <span class="string">"red"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"center"</span>, legend = <span class="string">"2004"</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r">bp &lt;- <span class="functioncall">barplot</span>(zz2)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'zz2' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">text</span>(bp, 0.97, labels = <span class="functioncall">table</span>(ss2$siteOfOriginPedigree), col = <span class="string">"red"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: object 'bp' not found
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">legend</span>(<span class="string">"center"</span>, legend = <span class="string">"2005"</span>, bty = <span class="string">"n"</span>)
</pre></div><div class="error"><pre class="knitr r">## Error: plot.new has not been called yet
</pre></div><div class="source"><pre class="knitr r"><span class="functioncall">par</span>(mfcol = <span class="functioncall">c</span>(1, 1))
</pre></div></div></div>


While there are differences among sites, they are not terribly striking. RI and MAPP seem to have relatively low levels of aphid infestation relative to other sites in 2004 and 2005. 

</body>
</html>
